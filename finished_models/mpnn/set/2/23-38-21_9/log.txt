2017-10-27 23:38:21,919 models/MPNN/set/Oct-27/23-38-21_9/log.txt
2017-10-27 23:38:21,919 models/MPNN/set/Oct-27/23-38-21_9
2017-10-27 23:38:21,920 Logfile at models/MPNN/set/Oct-27/23-38-21_9/log.txt
2017-10-27 23:38:21,920 	batch_size = 100
2017-10-27 23:38:21,920 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 23:38:21,920 	debug = False
2017-10-27 23:38:21,920 	decay = 0.94
2017-10-27 23:38:21,920 	dont_add_cropped = False
2017-10-27 23:38:21,920 	epochs = 20
2017-10-27 23:38:21,921 	extra_tag = 9
2017-10-27 23:38:21,921 	features = 7
2017-10-27 23:38:21,921 	filename = antikt-kt
2017-10-27 23:38:21,921 	gpu = 0
2017-10-27 23:38:21,921 	hidden = 40
2017-10-27 23:38:21,921 	iters = 1
2017-10-27 23:38:21,921 	leaves = True
2017-10-27 23:38:21,921 	load = /home/ih692/jets/models/MPNN/set/Oct-26/9
2017-10-27 23:38:21,921 	model_type = 7
2017-10-27 23:38:21,921 	n_train = -1
2017-10-27 23:38:21,921 	n_valid = 27000
2017-10-27 23:38:21,921 	not_leaves = False
2017-10-27 23:38:21,921 	password = deeplearning
2017-10-27 23:38:21,921 	recipient = henrion@nyu.edu
2017-10-27 23:38:21,921 	restart = True
2017-10-27 23:38:21,921 	seed = 12943
2017-10-27 23:38:21,921 	sender = results74207281@gmail.com
2017-10-27 23:38:21,921 	silent = True
2017-10-27 23:38:21,921 	step_size = 0.001
2017-10-27 23:38:21,921 	verbose = False
2017-10-27 23:38:21,921 	PID = 183445
2017-10-27 23:38:21,921 	Not running on GPU
2017-10-27 23:38:21,921 Loading data...
2017-10-27 23:38:21,924 TF already computed. Loading it.
2017-10-27 23:38:24,812 Data loaded and already preprocessed
2017-10-27 23:38:28,610 Splitting into train and validation...
2017-10-27 23:38:28,636 	raw train size = 73000
2017-10-27 23:38:28,636 	raw valid size = 27000
2017-10-27 23:38:28,636 Cropping...
2017-10-27 23:38:31,533 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 23:38:39,422 	final train size = 89813
2017-10-27 23:38:39,423 	final valid size = 10187
2017-10-27 23:38:39,423 Initializing model...
2017-10-27 23:38:39,466 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2Set (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 23:38:39,467 Number of parameters: 41523
2017-10-27 23:38:39,467 Building optimizer...
2017-10-27 23:38:39,470 Training...
2017-10-27 23:38:39,470 epoch = 0
2017-10-27 23:38:39,470 step_size = 0.00022650
2017-10-28 00:10:06,426 Modeling validation data took 156.64640474319458s
2017-10-28 00:10:06,452   898	~loss(train)=0.3904	loss(valid)=0.3496	roc_auc(valid)=0.9219	1/FPR @ TPR = 0.5: 81.47	Best 1/FPR @ TPR = 0.5: 81.47
2017-10-28 00:10:08,519 Epoch took 1889.048986196518 seconds
2017-10-28 00:10:08,519 epoch = 1
2017-10-28 00:10:08,520 step_size = 0.00021291
2017-10-28 00:41:31,547 Modeling validation data took 156.75376105308533s
2017-10-28 00:41:31,597  1796	~loss(train)=0.3873	loss(valid)=0.3481	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 86.18	Best 1/FPR @ TPR = 0.5: 86.18
2017-10-28 00:41:33,456 Epoch took 1884.9366755485535 seconds
2017-10-28 00:41:33,457 epoch = 2
2017-10-28 00:41:33,457 step_size = 0.00020014
2017-10-28 01:12:16,408 Modeling validation data took 151.4296157360077s
2017-10-28 01:12:16,436  2694	~loss(train)=0.3880	loss(valid)=0.3452	roc_auc(valid)=0.9231	1/FPR @ TPR = 0.5: 93.34	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 01:12:18,352 Epoch took 1844.8946163654327 seconds
2017-10-28 01:12:18,352 epoch = 3
2017-10-28 01:12:18,352 step_size = 0.00018813
2017-10-28 01:43:31,319 Modeling validation data took 175.03808116912842s
2017-10-28 01:43:31,343  3592	~loss(train)=0.3874	loss(valid)=0.3466	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 85.21	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 01:43:33,245 Epoch took 1874.8929479122162 seconds
2017-10-28 01:43:33,245 epoch = 4
2017-10-28 01:43:33,245 step_size = 0.00017684
2017-10-28 02:14:25,092 Modeling validation data took 158.42014837265015s
2017-10-28 02:14:25,135  4490	~loss(train)=0.3877	loss(valid)=0.3481	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 82.37	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 02:14:27,249 Epoch took 1854.0032150745392 seconds
2017-10-28 02:14:27,249 epoch = 5
2017-10-28 02:14:27,249 step_size = 0.00016623
2017-10-28 02:45:58,526 Modeling validation data took 178.1018476486206s
2017-10-28 02:45:58,573  5388	~loss(train)=0.3865	loss(valid)=0.3463	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 89.79	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 02:46:00,394 Epoch took 1893.1450333595276 seconds
2017-10-28 02:46:00,394 epoch = 6
2017-10-28 02:46:00,394 step_size = 0.00015626
2017-10-28 03:16:58,724 Modeling validation data took 157.59869933128357s
2017-10-28 03:16:58,750  6286	~loss(train)=0.3876	loss(valid)=0.3473	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 84.02	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 03:17:00,990 Epoch took 1860.5953528881073 seconds
2017-10-28 03:17:00,990 epoch = 7
2017-10-28 03:17:00,990 step_size = 0.00014688
2017-10-28 03:49:03,528 Modeling validation data took 178.3648021221161s
2017-10-28 03:49:03,556  7184	~loss(train)=0.3850	loss(valid)=0.3461	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 85.72	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 03:49:06,075 Epoch took 1925.0853071212769 seconds
2017-10-28 03:49:06,076 epoch = 8
2017-10-28 03:49:06,076 step_size = 0.00013807
2017-10-28 04:20:13,268 Modeling validation data took 159.61788320541382s
2017-10-28 04:20:13,297  8082	~loss(train)=0.3857	loss(valid)=0.3464	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 89.03	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 04:20:15,386 Epoch took 1869.3105163574219 seconds
2017-10-28 04:20:15,386 epoch = 9
2017-10-28 04:20:15,386 step_size = 0.00012978
2017-10-28 04:51:36,604 Modeling validation data took 156.2814745903015s
2017-10-28 04:51:36,644  8980	~loss(train)=0.3882	loss(valid)=0.3477	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 80.02	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 04:51:38,742 Epoch took 1883.3558621406555 seconds
2017-10-28 04:51:38,743 epoch = 10
2017-10-28 04:51:38,743 step_size = 0.00012200
2017-10-28 05:23:02,430 Modeling validation data took 147.92659378051758s
2017-10-28 05:23:02,450  9878	~loss(train)=0.3843	loss(valid)=0.3455	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 83.97	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 05:23:04,422 Epoch took 1885.6792569160461 seconds
2017-10-28 05:23:04,423 epoch = 11
2017-10-28 05:23:04,423 step_size = 0.00011468
2017-10-28 05:52:08,867 Modeling validation data took 147.91264748573303s
2017-10-28 05:52:08,905 10776	~loss(train)=0.3847	loss(valid)=0.3471	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 89.25	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 05:52:11,221 Epoch took 1746.7984054088593 seconds
2017-10-28 05:52:11,221 epoch = 12
2017-10-28 05:52:11,221 step_size = 0.00010780
2017-10-28 06:19:57,620 Modeling validation data took 156.28220081329346s
2017-10-28 06:19:57,694 11674	~loss(train)=0.3835	loss(valid)=0.3461	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 89.87	Best 1/FPR @ TPR = 0.5: 93.34
2017-10-28 06:19:59,606 Epoch took 1668.3848330974579 seconds
2017-10-28 06:19:59,607 epoch = 13
2017-10-28 06:19:59,607 step_size = 0.00010133
2017-10-28 06:48:21,389 Modeling validation data took 154.29913854599s
2017-10-28 06:48:21,437 12572	~loss(train)=0.3879	loss(valid)=0.3459	roc_auc(valid)=0.9232	1/FPR @ TPR = 0.5: 102.21	Best 1/FPR @ TPR = 0.5: 102.21
2017-10-28 06:48:23,129 Epoch took 1703.522521018982 seconds
2017-10-28 06:48:23,130 epoch = 14
2017-10-28 06:48:23,130 step_size = 0.00009525
2017-10-28 07:16:22,538 Modeling validation data took 154.71213603019714s
2017-10-28 07:16:22,565 13470	~loss(train)=0.3853	loss(valid)=0.3458	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 85.09	Best 1/FPR @ TPR = 0.5: 102.21
2017-10-28 07:16:23,910 Epoch took 1680.7805824279785 seconds
2017-10-28 07:16:23,911 epoch = 15
2017-10-28 07:16:23,911 step_size = 0.00008953
2017-10-28 07:43:52,572 Modeling validation data took 152.2450623512268s
2017-10-28 07:43:52,612 14368	~loss(train)=0.3845	loss(valid)=0.3463	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 87.02	Best 1/FPR @ TPR = 0.5: 102.21
2017-10-28 07:43:54,038 Epoch took 1650.1277751922607 seconds
2017-10-28 07:43:54,039 epoch = 16
2017-10-28 07:43:54,039 step_size = 0.00008416
2017-10-28 08:11:02,084 Modeling validation data took 148.77957391738892s
2017-10-28 08:11:02,112 15266	~loss(train)=0.3857	loss(valid)=0.3472	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 87.75	Best 1/FPR @ TPR = 0.5: 102.21
2017-10-28 08:11:04,044 Epoch took 1630.0054876804352 seconds
2017-10-28 08:11:04,045 epoch = 17
2017-10-28 08:11:04,045 step_size = 0.00007911
2017-10-28 08:39:11,940 Modeling validation data took 162.27790236473083s
2017-10-28 08:39:11,968 16164	~loss(train)=0.3840	loss(valid)=0.3462	roc_auc(valid)=0.9228	1/FPR @ TPR = 0.5: 89.07	Best 1/FPR @ TPR = 0.5: 102.21
2017-10-28 08:39:13,271 Epoch took 1689.2261326313019 seconds
2017-10-28 08:39:13,271 epoch = 18
2017-10-28 08:39:13,271 step_size = 0.00007437
2017-10-28 09:07:18,577 Modeling validation data took 151.93777322769165s
2017-10-28 09:07:18,652 17062	~loss(train)=0.3845	loss(valid)=0.3458	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 97.43	Best 1/FPR @ TPR = 0.5: 102.21
2017-10-28 09:07:20,305 Epoch took 1687.033437013626 seconds
2017-10-28 09:07:20,305 epoch = 19
2017-10-28 09:07:20,305 step_size = 0.00006990
2017-10-28 09:35:35,522 Modeling validation data took 149.41640424728394s
2017-10-28 09:35:35,551 17960	~loss(train)=0.3842	loss(valid)=0.3485	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 83.01	Best 1/FPR @ TPR = 0.5: 102.21
2017-10-28 09:35:37,246 Epoch took 1696.9410290718079 seconds
2017-10-28 09:35:37,246 FINISHED TRAINING
2017-10-28 09:35:37,246 Results in models/MPNN/set/Oct-27/23-38-21_9
2017-10-28 09:35:37,246 COMPLETED on Oct-28 at 09:35:37
2017-10-28 09:35:38,674 SENT EMAIL
