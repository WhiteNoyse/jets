2017-10-27 16:27:49,793 models/MPNN/set/Oct-27/16-27-49_4/log.txt
2017-10-27 16:27:49,793 models/MPNN/set/Oct-27/16-27-49_4
2017-10-27 16:27:49,794 Logfile at models/MPNN/set/Oct-27/16-27-49_4/log.txt
2017-10-27 16:27:49,794 	batch_size = 100
2017-10-27 16:27:49,794 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 16:27:49,794 	debug = False
2017-10-27 16:27:49,795 	decay = 0.94
2017-10-27 16:27:49,795 	dont_add_cropped = False
2017-10-27 16:27:49,795 	epochs = 20
2017-10-27 16:27:49,795 	extra_tag = 4
2017-10-27 16:27:49,795 	features = 7
2017-10-27 16:27:49,795 	filename = antikt-kt
2017-10-27 16:27:49,795 	gpu = 0
2017-10-27 16:27:49,795 	hidden = 40
2017-10-27 16:27:49,795 	iters = 1
2017-10-27 16:27:49,795 	leaves = True
2017-10-27 16:27:49,795 	load = /home/ih692/jets/models/MPNN/set/Oct-26/4
2017-10-27 16:27:49,795 	model_type = 7
2017-10-27 16:27:49,795 	n_train = -1
2017-10-27 16:27:49,795 	n_valid = 27000
2017-10-27 16:27:49,795 	not_leaves = False
2017-10-27 16:27:49,795 	password = deeplearning
2017-10-27 16:27:49,796 	recipient = henrion@nyu.edu
2017-10-27 16:27:49,796 	restart = True
2017-10-27 16:27:49,796 	seed = 34054
2017-10-27 16:27:49,796 	sender = results74207281@gmail.com
2017-10-27 16:27:49,796 	silent = True
2017-10-27 16:27:49,796 	step_size = 0.001
2017-10-27 16:27:49,796 	verbose = False
2017-10-27 16:27:49,796 	PID = 92400
2017-10-27 16:27:49,796 	Not running on GPU
2017-10-27 16:27:49,796 Loading data...
2017-10-27 16:27:49,797 TF already computed. Loading it.
2017-10-27 16:27:51,884 Data loaded and already preprocessed
2017-10-27 16:27:55,054 Splitting into train and validation...
2017-10-27 16:27:55,096 	raw train size = 73000
2017-10-27 16:27:55,096 	raw valid size = 27000
2017-10-27 16:27:55,096 Cropping...
2017-10-27 16:27:57,691 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 16:28:04,974 	final train size = 89813
2017-10-27 16:28:04,974 	final valid size = 10187
2017-10-27 16:28:04,974 Initializing model...
2017-10-27 16:28:05,028 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2Set (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 16:28:05,029 Number of parameters: 41523
2017-10-27 16:28:05,029 Building optimizer...
2017-10-27 16:28:05,032 Training...
2017-10-27 16:28:05,033 epoch = 0
2017-10-27 16:28:05,033 step_size = 0.00021291
2017-10-27 16:55:56,192 Modeling validation data took 158.3480086326599s
2017-10-27 16:55:56,203   898	~loss(train)=0.3908	loss(valid)=0.3512	roc_auc(valid)=0.9215	1/FPR @ TPR = 0.5: 85.72	Best 1/FPR @ TPR = 0.5: 85.72
2017-10-27 16:55:57,627 Epoch took 1672.5942752361298 seconds
2017-10-27 16:55:57,627 epoch = 1
2017-10-27 16:55:57,627 step_size = 0.00020014
2017-10-27 17:24:24,283 Modeling validation data took 143.59136652946472s
2017-10-27 17:24:24,307  1796	~loss(train)=0.3879	loss(valid)=0.3490	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 82.94	Best 1/FPR @ TPR = 0.5: 85.72
2017-10-27 17:24:25,667 Epoch took 1708.0399646759033 seconds
2017-10-27 17:24:25,668 epoch = 2
2017-10-27 17:24:25,668 step_size = 0.00018813
2017-10-27 17:52:57,319 Modeling validation data took 152.6399221420288s
2017-10-27 17:52:57,326  2694	~loss(train)=0.3938	loss(valid)=0.3527	roc_auc(valid)=0.9218	1/FPR @ TPR = 0.5: 82.85	Best 1/FPR @ TPR = 0.5: 85.72
2017-10-27 17:52:59,352 Epoch took 1713.6845812797546 seconds
2017-10-27 17:52:59,353 epoch = 3
2017-10-27 17:52:59,353 step_size = 0.00017684
2017-10-27 18:22:50,132 Modeling validation data took 151.83243799209595s
2017-10-27 18:22:50,154  3592	~loss(train)=0.3863	loss(valid)=0.3482	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 86.74	Best 1/FPR @ TPR = 0.5: 86.74
2017-10-27 18:22:51,852 Epoch took 1792.4989264011383 seconds
2017-10-27 18:22:51,852 epoch = 4
2017-10-27 18:22:51,852 step_size = 0.00016623
2017-10-27 18:51:51,289 Modeling validation data took 151.97986435890198s
2017-10-27 18:51:51,298  4490	~loss(train)=0.3857	loss(valid)=0.3494	roc_auc(valid)=0.9219	1/FPR @ TPR = 0.5: 89.32	Best 1/FPR @ TPR = 0.5: 89.32
2017-10-27 18:51:52,788 Epoch took 1740.935525894165 seconds
2017-10-27 18:51:52,788 epoch = 5
2017-10-27 18:51:52,788 step_size = 0.00015626
2017-10-27 19:20:29,242 Modeling validation data took 151.3817617893219s
2017-10-27 19:20:29,248  5388	~loss(train)=0.3880	loss(valid)=0.3494	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 81.84	Best 1/FPR @ TPR = 0.5: 89.32
2017-10-27 19:20:30,949 Epoch took 1718.1612079143524 seconds
2017-10-27 19:20:30,950 epoch = 6
2017-10-27 19:20:30,950 step_size = 0.00014688
2017-10-27 19:48:50,603 Modeling validation data took 150.4832043647766s
2017-10-27 19:48:50,612  6286	~loss(train)=0.3848	loss(valid)=0.3484	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 97.68	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 19:48:51,760 Epoch took 1700.810389995575 seconds
2017-10-27 19:48:51,761 epoch = 7
2017-10-27 19:48:51,761 step_size = 0.00013807
2017-10-27 20:17:38,207 Modeling validation data took 141.8107569217682s
2017-10-27 20:17:38,213  7184	~loss(train)=0.3852	loss(valid)=0.3488	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 88.95	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 20:17:39,860 Epoch took 1728.0990092754364 seconds
2017-10-27 20:17:39,860 epoch = 8
2017-10-27 20:17:39,860 step_size = 0.00012978
2017-10-27 20:46:02,106 Modeling validation data took 149.17243552207947s
2017-10-27 20:46:02,112  8082	~loss(train)=0.3870	loss(valid)=0.3496	roc_auc(valid)=0.9219	1/FPR @ TPR = 0.5: 89.28	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 20:46:03,388 Epoch took 1703.5272200107574 seconds
2017-10-27 20:46:03,388 epoch = 9
2017-10-27 20:46:03,388 step_size = 0.00012200
2017-10-27 21:14:52,751 Modeling validation data took 148.06186938285828s
2017-10-27 21:14:52,758  8980	~loss(train)=0.3875	loss(valid)=0.3498	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 86.53	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 21:14:54,065 Epoch took 1730.6764180660248 seconds
2017-10-27 21:14:54,065 epoch = 10
2017-10-27 21:14:54,065 step_size = 0.00011468
2017-10-27 21:42:29,942 Modeling validation data took 148.64740204811096s
2017-10-27 21:42:29,948  9878	~loss(train)=0.3882	loss(valid)=0.3499	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 74.40	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 21:42:31,598 Epoch took 1657.5326981544495 seconds
2017-10-27 21:42:31,598 epoch = 11
2017-10-27 21:42:31,598 step_size = 0.00010780
2017-10-27 22:11:21,116 Modeling validation data took 149.18703293800354s
2017-10-27 22:11:21,123 10776	~loss(train)=0.3857	loss(valid)=0.3488	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 76.81	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 22:11:23,780 Epoch took 1732.181235551834 seconds
2017-10-27 22:11:23,780 epoch = 12
2017-10-27 22:11:23,780 step_size = 0.00010133
2017-10-27 22:40:15,129 Modeling validation data took 151.86174702644348s
2017-10-27 22:40:15,136 11674	~loss(train)=0.3829	loss(valid)=0.3471	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 88.04	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 22:40:16,451 Epoch took 1732.6706244945526 seconds
2017-10-27 22:40:16,451 epoch = 13
2017-10-27 22:40:16,451 step_size = 0.00009525
2017-10-27 23:08:09,773 Modeling validation data took 147.03830695152283s
2017-10-27 23:08:09,780 12572	~loss(train)=0.3840	loss(valid)=0.3477	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 89.95	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 23:08:11,216 Epoch took 1674.7652928829193 seconds
2017-10-27 23:08:11,217 epoch = 14
2017-10-27 23:08:11,217 step_size = 0.00008953
2017-10-27 23:35:48,303 Modeling validation data took 143.23380541801453s
2017-10-27 23:35:48,323 13470	~loss(train)=0.3841	loss(valid)=0.3476	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 83.76	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-27 23:35:49,615 Epoch took 1658.3986637592316 seconds
2017-10-27 23:35:49,616 epoch = 15
2017-10-27 23:35:49,616 step_size = 0.00008416
2017-10-28 00:04:58,169 Modeling validation data took 139.27637219429016s
2017-10-28 00:04:58,191 14368	~loss(train)=0.3853	loss(valid)=0.3501	roc_auc(valid)=0.9212	1/FPR @ TPR = 0.5: 78.61	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-28 00:04:59,670 Epoch took 1750.0542466640472 seconds
2017-10-28 00:04:59,671 epoch = 16
2017-10-28 00:04:59,671 step_size = 0.00007911
2017-10-28 00:34:45,146 Modeling validation data took 142.4832262992859s
2017-10-28 00:34:45,173 15266	~loss(train)=0.3830	loss(valid)=0.3473	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 91.99	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-28 00:34:47,131 Epoch took 1787.4602117538452 seconds
2017-10-28 00:34:47,131 epoch = 17
2017-10-28 00:34:47,131 step_size = 0.00007437
2017-10-28 01:04:12,817 Modeling validation data took 140.28330254554749s
2017-10-28 01:04:12,850 16164	~loss(train)=0.3840	loss(valid)=0.3486	roc_auc(valid)=0.9218	1/FPR @ TPR = 0.5: 77.31	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-28 01:04:14,119 Epoch took 1766.9876787662506 seconds
2017-10-28 01:04:14,120 epoch = 18
2017-10-28 01:04:14,120 step_size = 0.00006990
2017-10-28 01:34:29,139 Modeling validation data took 141.7926800251007s
2017-10-28 01:34:29,165 17062	~loss(train)=0.3822	loss(valid)=0.3479	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 90.13	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-28 01:34:31,374 Epoch took 1817.254711151123 seconds
2017-10-28 01:34:31,375 epoch = 19
2017-10-28 01:34:31,375 step_size = 0.00006571
2017-10-28 02:04:05,237 Modeling validation data took 139.1360638141632s
2017-10-28 02:04:05,263 17960	~loss(train)=0.3822	loss(valid)=0.3468	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 83.36	Best 1/FPR @ TPR = 0.5: 97.68
2017-10-28 02:04:06,717 Epoch took 1775.3416669368744 seconds
2017-10-28 02:04:06,717 FINISHED TRAINING
2017-10-28 02:04:06,717 Results in models/MPNN/set/Oct-27/16-27-49_4
2017-10-28 02:04:06,717 COMPLETED on Oct-28 at 02:04:06
2017-10-28 02:04:07,527 SENT EMAIL
