2017-10-27 19:05:57,532 models/MPNN/set/Oct-27/19-05-57_8/log.txt
2017-10-27 19:05:57,532 models/MPNN/set/Oct-27/19-05-57_8
2017-10-27 19:05:57,533 Logfile at models/MPNN/set/Oct-27/19-05-57_8/log.txt
2017-10-27 19:05:57,534 	batch_size = 100
2017-10-27 19:05:57,534 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 19:05:57,534 	debug = False
2017-10-27 19:05:57,534 	decay = 0.94
2017-10-27 19:05:57,534 	dont_add_cropped = False
2017-10-27 19:05:57,534 	epochs = 20
2017-10-27 19:05:57,534 	extra_tag = 8
2017-10-27 19:05:57,534 	features = 7
2017-10-27 19:05:57,535 	filename = antikt-kt
2017-10-27 19:05:57,535 	gpu = 0
2017-10-27 19:05:57,535 	hidden = 40
2017-10-27 19:05:57,535 	iters = 1
2017-10-27 19:05:57,535 	leaves = True
2017-10-27 19:05:57,535 	load = /home/ih692/jets/models/MPNN/set/Oct-26/8
2017-10-27 19:05:57,535 	model_type = 7
2017-10-27 19:05:57,535 	n_train = -1
2017-10-27 19:05:57,536 	n_valid = 27000
2017-10-27 19:05:57,536 	not_leaves = False
2017-10-27 19:05:57,536 	password = deeplearning
2017-10-27 19:05:57,536 	recipient = henrion@nyu.edu
2017-10-27 19:05:57,536 	restart = True
2017-10-27 19:05:57,536 	seed = 50603
2017-10-27 19:05:57,536 	sender = results74207281@gmail.com
2017-10-27 19:05:57,536 	silent = True
2017-10-27 19:05:57,536 	step_size = 0.001
2017-10-27 19:05:57,537 	verbose = False
2017-10-27 19:05:57,537 	PID = 15544
2017-10-27 19:05:57,537 	Not running on GPU
2017-10-27 19:05:57,537 Loading data...
2017-10-27 19:05:57,538 TF already computed. Loading it.
2017-10-27 19:06:01,755 Data loaded and already preprocessed
2017-10-27 19:06:06,855 Splitting into train and validation...
2017-10-27 19:06:06,879 	raw train size = 73000
2017-10-27 19:06:06,879 	raw valid size = 27000
2017-10-27 19:06:06,879 Cropping...
2017-10-27 19:06:09,469 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 19:06:16,167 	final train size = 89813
2017-10-27 19:06:16,167 	final valid size = 10187
2017-10-27 19:06:16,167 Initializing model...
2017-10-27 19:06:16,216 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2Set (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 19:06:16,217 Number of parameters: 41523
2017-10-27 19:06:16,217 Building optimizer...
2017-10-27 19:06:16,220 Training...
2017-10-27 19:06:16,220 epoch = 0
2017-10-27 19:06:16,220 step_size = 0.00032832
2017-10-27 19:30:05,649 Modeling validation data took 143.7520353794098s
2017-10-27 19:30:05,658   898	~loss(train)=0.3895	loss(valid)=0.3497	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 89.80	Best 1/FPR @ TPR = 0.5: 89.80
2017-10-27 19:30:07,344 Epoch took 1431.1241524219513 seconds
2017-10-27 19:30:07,345 epoch = 1
2017-10-27 19:30:07,345 step_size = 0.00030862
2017-10-27 19:54:14,929 Modeling validation data took 143.9922218322754s
2017-10-27 19:54:14,935  1796	~loss(train)=0.3886	loss(valid)=0.3473	roc_auc(valid)=0.9219	1/FPR @ TPR = 0.5: 85.32	Best 1/FPR @ TPR = 0.5: 89.80
2017-10-27 19:54:15,987 Epoch took 1448.6418001651764 seconds
2017-10-27 19:54:15,987 epoch = 2
2017-10-27 19:54:15,987 step_size = 0.00029011
2017-10-27 20:18:20,848 Modeling validation data took 144.30477738380432s
2017-10-27 20:18:20,854  2694	~loss(train)=0.3865	loss(valid)=0.3469	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 82.69	Best 1/FPR @ TPR = 0.5: 89.80
2017-10-27 20:18:21,936 Epoch took 1445.9484169483185 seconds
2017-10-27 20:18:21,936 epoch = 3
2017-10-27 20:18:21,936 step_size = 0.00027270
2017-10-27 20:42:01,519 Modeling validation data took 144.03158521652222s
2017-10-27 20:42:01,525  3592	~loss(train)=0.3855	loss(valid)=0.3471	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 82.05	Best 1/FPR @ TPR = 0.5: 89.80
2017-10-27 20:42:03,016 Epoch took 1421.0799140930176 seconds
2017-10-27 20:42:03,016 epoch = 4
2017-10-27 20:42:03,016 step_size = 0.00025634
2017-10-27 21:06:00,868 Modeling validation data took 143.89793157577515s
2017-10-27 21:06:00,875  4490	~loss(train)=0.3873	loss(valid)=0.3461	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 87.73	Best 1/FPR @ TPR = 0.5: 89.80
2017-10-27 21:06:02,080 Epoch took 1439.0638945102692 seconds
2017-10-27 21:06:02,080 epoch = 5
2017-10-27 21:06:02,080 step_size = 0.00024096
2017-10-27 21:30:05,169 Modeling validation data took 143.9030511379242s
2017-10-27 21:30:05,178  5388	~loss(train)=0.3853	loss(valid)=0.3466	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 92.60	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-27 21:30:06,635 Epoch took 1444.5548810958862 seconds
2017-10-27 21:30:06,636 epoch = 6
2017-10-27 21:30:06,636 step_size = 0.00022650
2017-10-27 21:54:01,299 Modeling validation data took 144.2940754890442s
2017-10-27 21:54:01,306  6286	~loss(train)=0.3848	loss(valid)=0.3465	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 88.05	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-27 21:54:03,002 Epoch took 1436.366180896759 seconds
2017-10-27 21:54:03,002 epoch = 7
2017-10-27 21:54:03,002 step_size = 0.00021291
2017-10-27 22:18:01,841 Modeling validation data took 144.0953197479248s
2017-10-27 22:18:01,847  7184	~loss(train)=0.3851	loss(valid)=0.3470	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 90.02	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-27 22:18:03,185 Epoch took 1440.1822736263275 seconds
2017-10-27 22:18:03,185 epoch = 8
2017-10-27 22:18:03,185 step_size = 0.00020014
2017-10-27 22:42:10,509 Modeling validation data took 144.267019033432s
2017-10-27 22:42:10,516  8082	~loss(train)=0.3862	loss(valid)=0.3472	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 89.95	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-27 22:42:12,027 Epoch took 1448.842227935791 seconds
2017-10-27 22:42:12,028 epoch = 9
2017-10-27 22:42:12,028 step_size = 0.00018813
2017-10-27 23:06:24,205 Modeling validation data took 144.06414771080017s
2017-10-27 23:06:24,211  8980	~loss(train)=0.3860	loss(valid)=0.3500	roc_auc(valid)=0.9211	1/FPR @ TPR = 0.5: 86.57	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-27 23:06:25,448 Epoch took 1453.419932126999 seconds
2017-10-27 23:06:25,448 epoch = 10
2017-10-27 23:06:25,448 step_size = 0.00017684
2017-10-27 23:30:31,173 Modeling validation data took 143.97581481933594s
2017-10-27 23:30:31,184  9878	~loss(train)=0.3864	loss(valid)=0.3501	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 70.89	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-27 23:30:32,255 Epoch took 1446.806792497635 seconds
2017-10-27 23:30:32,255 epoch = 11
2017-10-27 23:30:32,255 step_size = 0.00016623
2017-10-27 23:54:45,476 Modeling validation data took 144.05846166610718s
2017-10-27 23:54:45,501 10776	~loss(train)=0.3858	loss(valid)=0.3472	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 84.33	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-27 23:54:46,697 Epoch took 1454.4415543079376 seconds
2017-10-27 23:54:46,697 epoch = 12
2017-10-27 23:54:46,697 step_size = 0.00015626
2017-10-28 00:18:58,089 Modeling validation data took 144.26451563835144s
2017-10-28 00:18:58,131 11674	~loss(train)=0.3862	loss(valid)=0.3511	roc_auc(valid)=0.9205	1/FPR @ TPR = 0.5: 63.59	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-28 00:18:59,422 Epoch took 1452.724305152893 seconds
2017-10-28 00:18:59,422 epoch = 13
2017-10-28 00:18:59,422 step_size = 0.00014688
2017-10-28 00:42:56,220 Modeling validation data took 144.10095477104187s
2017-10-28 00:42:56,253 12572	~loss(train)=0.3852	loss(valid)=0.3490	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 83.58	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-28 00:42:57,331 Epoch took 1437.9090683460236 seconds
2017-10-28 00:42:57,331 epoch = 14
2017-10-28 00:42:57,331 step_size = 0.00013807
2017-10-28 01:06:57,001 Modeling validation data took 144.12020206451416s
2017-10-28 01:06:57,023 13470	~loss(train)=0.3854	loss(valid)=0.3497	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 80.35	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-28 01:06:58,631 Epoch took 1441.2998340129852 seconds
2017-10-28 01:06:58,632 epoch = 15
2017-10-28 01:06:58,632 step_size = 0.00012978
2017-10-28 01:31:23,745 Modeling validation data took 144.03384399414062s
2017-10-28 01:31:23,767 14368	~loss(train)=0.3835	loss(valid)=0.3469	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 85.22	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-28 01:31:24,918 Epoch took 1466.2862255573273 seconds
2017-10-28 01:31:24,918 epoch = 16
2017-10-28 01:31:24,918 step_size = 0.00012200
2017-10-28 01:55:43,427 Modeling validation data took 144.02867984771729s
2017-10-28 01:55:43,446 15266	~loss(train)=0.3815	loss(valid)=0.3462	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 83.94	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-28 01:55:45,434 Epoch took 1460.5156784057617 seconds
2017-10-28 01:55:45,434 epoch = 17
2017-10-28 01:55:45,434 step_size = 0.00011468
2017-10-28 02:19:50,444 Modeling validation data took 143.98616456985474s
2017-10-28 02:19:50,473 16164	~loss(train)=0.3825	loss(valid)=0.3467	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 88.12	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-28 02:19:51,874 Epoch took 1446.4398248195648 seconds
2017-10-28 02:19:51,875 epoch = 18
2017-10-28 02:19:51,875 step_size = 0.00010780
2017-10-28 02:44:02,156 Modeling validation data took 144.05111598968506s
2017-10-28 02:44:02,192 17062	~loss(train)=0.3834	loss(valid)=0.3482	roc_auc(valid)=0.9215	1/FPR @ TPR = 0.5: 88.68	Best 1/FPR @ TPR = 0.5: 92.60
2017-10-28 02:44:03,367 Epoch took 1451.4924154281616 seconds
2017-10-28 02:44:03,367 epoch = 19
2017-10-28 02:44:03,367 step_size = 0.00010133
2017-10-28 03:08:12,626 Modeling validation data took 144.35158920288086s
2017-10-28 03:08:12,657 17960	~loss(train)=0.3790	loss(valid)=0.3455	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 94.30	Best 1/FPR @ TPR = 0.5: 94.30
2017-10-28 03:08:14,088 Epoch took 1450.7209441661835 seconds
2017-10-28 03:08:14,089 FINISHED TRAINING
2017-10-28 03:08:14,089 Results in models/MPNN/set/Oct-27/19-05-57_8
2017-10-28 03:08:14,089 COMPLETED on Oct-28 at 03:08:14
2017-10-28 03:08:15,511 SENT EMAIL
