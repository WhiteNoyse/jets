2017-10-27 16:18:30,932 models/MPNN/set/Oct-27/16-18-30_3/log.txt
2017-10-27 16:18:30,932 models/MPNN/set/Oct-27/16-18-30_3
2017-10-27 16:18:30,933 Logfile at models/MPNN/set/Oct-27/16-18-30_3/log.txt
2017-10-27 16:18:30,933 	batch_size = 100
2017-10-27 16:18:30,934 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 16:18:30,934 	debug = False
2017-10-27 16:18:30,934 	decay = 0.94
2017-10-27 16:18:30,934 	dont_add_cropped = False
2017-10-27 16:18:30,934 	epochs = 20
2017-10-27 16:18:30,934 	extra_tag = 3
2017-10-27 16:18:30,934 	features = 7
2017-10-27 16:18:30,934 	filename = antikt-kt
2017-10-27 16:18:30,934 	gpu = 0
2017-10-27 16:18:30,934 	hidden = 40
2017-10-27 16:18:30,934 	iters = 1
2017-10-27 16:18:30,934 	leaves = True
2017-10-27 16:18:30,934 	load = /home/ih692/jets/models/MPNN/set/Oct-26/3
2017-10-27 16:18:30,934 	model_type = 7
2017-10-27 16:18:30,934 	n_train = -1
2017-10-27 16:18:30,935 	n_valid = 27000
2017-10-27 16:18:30,935 	not_leaves = False
2017-10-27 16:18:30,935 	password = deeplearning
2017-10-27 16:18:30,935 	recipient = henrion@nyu.edu
2017-10-27 16:18:30,935 	restart = True
2017-10-27 16:18:30,935 	seed = 8649
2017-10-27 16:18:30,935 	sender = results74207281@gmail.com
2017-10-27 16:18:30,935 	silent = True
2017-10-27 16:18:30,935 	step_size = 0.001
2017-10-27 16:18:30,935 	verbose = False
2017-10-27 16:18:30,935 	PID = 132827
2017-10-27 16:18:30,935 	Not running on GPU
2017-10-27 16:18:30,935 Loading data...
2017-10-27 16:18:30,937 TF already computed. Loading it.
2017-10-27 16:18:33,767 Data loaded and already preprocessed
2017-10-27 16:18:38,239 Splitting into train and validation...
2017-10-27 16:18:38,266 	raw train size = 73000
2017-10-27 16:18:38,266 	raw valid size = 27000
2017-10-27 16:18:38,266 Cropping...
2017-10-27 16:18:41,069 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 16:18:49,191 	final train size = 89813
2017-10-27 16:18:49,192 	final valid size = 10187
2017-10-27 16:18:49,192 Initializing model...
2017-10-27 16:18:49,244 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2Set (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 16:18:49,245 Number of parameters: 41523
2017-10-27 16:18:49,245 Building optimizer...
2017-10-27 16:18:49,249 Training...
2017-10-27 16:18:49,249 epoch = 0
2017-10-27 16:18:49,249 step_size = 0.00025634
2017-10-27 16:46:17,584 Modeling validation data took 148.56698560714722s
2017-10-27 16:46:17,593   898	~loss(train)=0.3889	loss(valid)=0.3497	roc_auc(valid)=0.9218	1/FPR @ TPR = 0.5: 68.29	Best 1/FPR @ TPR = 0.5: 68.29
2017-10-27 16:46:19,065 Epoch took 1649.8160438537598 seconds
2017-10-27 16:46:19,065 epoch = 1
2017-10-27 16:46:19,065 step_size = 0.00024096
2017-10-27 17:13:35,990 Modeling validation data took 149.6552984714508s
2017-10-27 17:13:35,999  1796	~loss(train)=0.3896	loss(valid)=0.3480	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 72.65	Best 1/FPR @ TPR = 0.5: 72.65
2017-10-27 17:13:38,054 Epoch took 1638.9883198738098 seconds
2017-10-27 17:13:38,054 epoch = 2
2017-10-27 17:13:38,054 step_size = 0.00022650
2017-10-27 17:41:12,561 Modeling validation data took 149.47831869125366s
2017-10-27 17:41:12,586  2694	~loss(train)=0.3880	loss(valid)=0.3482	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 78.58	Best 1/FPR @ TPR = 0.5: 78.58
2017-10-27 17:41:14,085 Epoch took 1656.0314037799835 seconds
2017-10-27 17:41:14,086 epoch = 3
2017-10-27 17:41:14,086 step_size = 0.00021291
2017-10-27 18:08:12,552 Modeling validation data took 150.0907039642334s
2017-10-27 18:08:12,558  3592	~loss(train)=0.3867	loss(valid)=0.3488	roc_auc(valid)=0.9219	1/FPR @ TPR = 0.5: 74.87	Best 1/FPR @ TPR = 0.5: 78.58
2017-10-27 18:08:14,070 Epoch took 1619.9844379425049 seconds
2017-10-27 18:08:14,070 epoch = 4
2017-10-27 18:08:14,070 step_size = 0.00020014
2017-10-27 18:34:53,086 Modeling validation data took 149.46462440490723s
2017-10-27 18:34:53,094  4490	~loss(train)=0.3876	loss(valid)=0.3475	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 78.36	Best 1/FPR @ TPR = 0.5: 78.58
2017-10-27 18:34:54,178 Epoch took 1600.10755777359 seconds
2017-10-27 18:34:54,178 epoch = 5
2017-10-27 18:34:54,178 step_size = 0.00018813
2017-10-27 19:02:08,494 Modeling validation data took 150.54180121421814s
2017-10-27 19:02:08,502  5388	~loss(train)=0.3877	loss(valid)=0.3489	roc_auc(valid)=0.9215	1/FPR @ TPR = 0.5: 80.99	Best 1/FPR @ TPR = 0.5: 80.99
2017-10-27 19:02:10,229 Epoch took 1636.0505669116974 seconds
2017-10-27 19:02:10,229 epoch = 6
2017-10-27 19:02:10,229 step_size = 0.00017684
2017-10-27 19:29:23,935 Modeling validation data took 149.91415739059448s
2017-10-27 19:29:23,945  6286	~loss(train)=0.3853	loss(valid)=0.3466	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 83.01	Best 1/FPR @ TPR = 0.5: 83.01
2017-10-27 19:29:25,770 Epoch took 1635.5401277542114 seconds
2017-10-27 19:29:25,770 epoch = 7
2017-10-27 19:29:25,770 step_size = 0.00016623
2017-10-27 19:56:34,934 Modeling validation data took 152.95916891098022s
2017-10-27 19:56:34,943  7184	~loss(train)=0.3895	loss(valid)=0.3498	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 87.37	Best 1/FPR @ TPR = 0.5: 87.37
2017-10-27 19:56:36,365 Epoch took 1630.5948407649994 seconds
2017-10-27 19:56:36,365 epoch = 8
2017-10-27 19:56:36,365 step_size = 0.00015626
2017-10-27 20:23:54,023 Modeling validation data took 149.23856568336487s
2017-10-27 20:23:54,030  8082	~loss(train)=0.3867	loss(valid)=0.3485	roc_auc(valid)=0.9218	1/FPR @ TPR = 0.5: 80.81	Best 1/FPR @ TPR = 0.5: 87.37
2017-10-27 20:23:55,447 Epoch took 1639.0813205242157 seconds
2017-10-27 20:23:55,447 epoch = 9
2017-10-27 20:23:55,447 step_size = 0.00014688
2017-10-27 20:51:31,216 Modeling validation data took 150.01095390319824s
2017-10-27 20:51:31,224  8980	~loss(train)=0.3871	loss(valid)=0.3488	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 89.06	Best 1/FPR @ TPR = 0.5: 89.06
2017-10-27 20:51:32,410 Epoch took 1656.9631230831146 seconds
2017-10-27 20:51:32,410 epoch = 10
2017-10-27 20:51:32,410 step_size = 0.00013807
2017-10-27 21:18:40,841 Modeling validation data took 151.31449174880981s
2017-10-27 21:18:40,850  9878	~loss(train)=0.3849	loss(valid)=0.3493	roc_auc(valid)=0.9214	1/FPR @ TPR = 0.5: 90.65	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-27 21:18:42,545 Epoch took 1630.1346833705902 seconds
2017-10-27 21:18:42,545 epoch = 11
2017-10-27 21:18:42,546 step_size = 0.00012978
2017-10-27 21:45:23,191 Modeling validation data took 151.17325115203857s
2017-10-27 21:45:23,197 10776	~loss(train)=0.3890	loss(valid)=0.3503	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 80.97	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-27 21:45:24,795 Epoch took 1602.2491481304169 seconds
2017-10-27 21:45:24,795 epoch = 12
2017-10-27 21:45:24,795 step_size = 0.00012200
2017-10-27 22:12:37,773 Modeling validation data took 152.30534100532532s
2017-10-27 22:12:37,780 11674	~loss(train)=0.3837	loss(valid)=0.3472	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 83.50	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-27 22:12:38,992 Epoch took 1634.1966345310211 seconds
2017-10-27 22:12:38,993 epoch = 13
2017-10-27 22:12:38,993 step_size = 0.00011468
2017-10-27 22:39:43,153 Modeling validation data took 150.3905816078186s
2017-10-27 22:39:43,159 12572	~loss(train)=0.3834	loss(valid)=0.3470	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 79.80	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-27 22:39:44,829 Epoch took 1625.835785627365 seconds
2017-10-27 22:39:44,829 epoch = 14
2017-10-27 22:39:44,829 step_size = 0.00010780
2017-10-27 23:07:08,523 Modeling validation data took 150.76724123954773s
2017-10-27 23:07:08,530 13470	~loss(train)=0.3838	loss(valid)=0.3470	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 75.88	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-27 23:07:09,994 Epoch took 1645.164971113205 seconds
2017-10-27 23:07:09,994 epoch = 15
2017-10-27 23:07:09,994 step_size = 0.00010133
2017-10-27 23:34:19,974 Modeling validation data took 150.7237732410431s
2017-10-27 23:34:19,992 14368	~loss(train)=0.3837	loss(valid)=0.3480	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 78.51	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-27 23:34:21,201 Epoch took 1631.2063682079315 seconds
2017-10-27 23:34:21,201 epoch = 16
2017-10-27 23:34:21,201 step_size = 0.00009525
2017-10-28 00:01:22,358 Modeling validation data took 149.0227246284485s
2017-10-28 00:01:22,384 15266	~loss(train)=0.3851	loss(valid)=0.3493	roc_auc(valid)=0.9219	1/FPR @ TPR = 0.5: 88.36	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-28 00:01:23,948 Epoch took 1622.7468271255493 seconds
2017-10-28 00:01:23,948 epoch = 17
2017-10-28 00:01:23,948 step_size = 0.00008953
2017-10-28 00:28:15,185 Modeling validation data took 148.5246615409851s
2017-10-28 00:28:15,214 16164	~loss(train)=0.3855	loss(valid)=0.3495	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 78.87	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-28 00:28:17,207 Epoch took 1613.2584874629974 seconds
2017-10-28 00:28:17,207 epoch = 18
2017-10-28 00:28:17,207 step_size = 0.00008416
2017-10-28 00:55:45,688 Modeling validation data took 152.43041372299194s
2017-10-28 00:55:45,712 17062	~loss(train)=0.3841	loss(valid)=0.3480	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 79.22	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-28 00:55:46,962 Epoch took 1649.7546474933624 seconds
2017-10-28 00:55:46,962 epoch = 19
2017-10-28 00:55:46,962 step_size = 0.00007911
2017-10-28 01:22:48,174 Modeling validation data took 148.71658444404602s
2017-10-28 01:22:48,186 17960	~loss(train)=0.3836	loss(valid)=0.3465	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 82.25	Best 1/FPR @ TPR = 0.5: 90.65
2017-10-28 01:22:50,222 Epoch took 1623.2601232528687 seconds
2017-10-28 01:22:50,223 FINISHED TRAINING
2017-10-28 01:22:50,223 Results in models/MPNN/set/Oct-27/16-18-30_3
2017-10-28 01:22:50,223 COMPLETED on Oct-28 at 01:22:50
2017-10-28 01:22:51,094 SENT EMAIL
