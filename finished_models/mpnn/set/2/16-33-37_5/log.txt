2017-10-27 16:33:37,056 models/MPNN/set/Oct-27/16-33-37_5/log.txt
2017-10-27 16:33:37,056 models/MPNN/set/Oct-27/16-33-37_5
2017-10-27 16:33:37,057 Logfile at models/MPNN/set/Oct-27/16-33-37_5/log.txt
2017-10-27 16:33:37,058 	batch_size = 100
2017-10-27 16:33:37,058 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 16:33:37,058 	debug = False
2017-10-27 16:33:37,058 	decay = 0.94
2017-10-27 16:33:37,058 	dont_add_cropped = False
2017-10-27 16:33:37,058 	epochs = 20
2017-10-27 16:33:37,058 	extra_tag = 5
2017-10-27 16:33:37,059 	features = 7
2017-10-27 16:33:37,059 	filename = antikt-kt
2017-10-27 16:33:37,059 	gpu = 0
2017-10-27 16:33:37,059 	hidden = 40
2017-10-27 16:33:37,059 	iters = 1
2017-10-27 16:33:37,059 	leaves = True
2017-10-27 16:33:37,059 	load = /home/ih692/jets/models/MPNN/set/Oct-26/5
2017-10-27 16:33:37,059 	model_type = 7
2017-10-27 16:33:37,059 	n_train = -1
2017-10-27 16:33:37,060 	n_valid = 27000
2017-10-27 16:33:37,060 	not_leaves = False
2017-10-27 16:33:37,060 	password = deeplearning
2017-10-27 16:33:37,060 	recipient = henrion@nyu.edu
2017-10-27 16:33:37,060 	restart = True
2017-10-27 16:33:37,060 	seed = 23719
2017-10-27 16:33:37,060 	sender = results74207281@gmail.com
2017-10-27 16:33:37,060 	silent = True
2017-10-27 16:33:37,060 	step_size = 0.001
2017-10-27 16:33:37,061 	verbose = False
2017-10-27 16:33:37,061 	PID = 5309
2017-10-27 16:33:37,061 	Not running on GPU
2017-10-27 16:33:37,061 Loading data...
2017-10-27 16:33:37,062 TF already computed. Loading it.
2017-10-27 16:33:40,224 Data loaded and already preprocessed
2017-10-27 16:33:45,326 Splitting into train and validation...
2017-10-27 16:33:45,351 	raw train size = 73000
2017-10-27 16:33:45,351 	raw valid size = 27000
2017-10-27 16:33:45,351 Cropping...
2017-10-27 16:33:47,765 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 16:33:54,688 	final train size = 89813
2017-10-27 16:33:54,688 	final valid size = 10187
2017-10-27 16:33:54,688 Initializing model...
2017-10-27 16:33:54,737 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2Set (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 16:33:54,738 Number of parameters: 41523
2017-10-27 16:33:54,738 Building optimizer...
2017-10-27 16:33:54,741 Training...
2017-10-27 16:33:54,741 epoch = 0
2017-10-27 16:33:54,741 step_size = 0.00018813
2017-10-27 17:00:52,087 Modeling validation data took 154.9607231616974s
2017-10-27 17:00:52,108   898	~loss(train)=0.3848	loss(valid)=0.3474	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 84.43	Best 1/FPR @ TPR = 0.5: 84.43
2017-10-27 17:00:53,429 Epoch took 1618.6872203350067 seconds
2017-10-27 17:00:53,429 epoch = 1
2017-10-27 17:00:53,429 step_size = 0.00017684
2017-10-27 17:27:47,771 Modeling validation data took 156.3039255142212s
2017-10-27 17:27:47,829  1796	~loss(train)=0.3848	loss(valid)=0.3474	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 91.40	Best 1/FPR @ TPR = 0.5: 91.40
2017-10-27 17:27:48,907 Epoch took 1615.478039264679 seconds
2017-10-27 17:27:48,907 epoch = 2
2017-10-27 17:27:48,907 step_size = 0.00016623
2017-10-27 17:55:05,638 Modeling validation data took 157.00938534736633s
2017-10-27 17:55:05,644  2694	~loss(train)=0.3849	loss(valid)=0.3479	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 91.16	Best 1/FPR @ TPR = 0.5: 91.40
2017-10-27 17:55:07,198 Epoch took 1638.2901537418365 seconds
2017-10-27 17:55:07,198 epoch = 3
2017-10-27 17:55:07,198 step_size = 0.00015626
2017-10-27 18:22:01,193 Modeling validation data took 155.87731218338013s
2017-10-27 18:22:01,200  3592	~loss(train)=0.3844	loss(valid)=0.3478	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 82.41	Best 1/FPR @ TPR = 0.5: 91.40
2017-10-27 18:22:02,429 Epoch took 1615.2308914661407 seconds
2017-10-27 18:22:02,429 epoch = 4
2017-10-27 18:22:02,429 step_size = 0.00014688
2017-10-27 18:49:05,036 Modeling validation data took 147.59384512901306s
2017-10-27 18:49:05,042  4490	~loss(train)=0.3847	loss(valid)=0.3475	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 81.45	Best 1/FPR @ TPR = 0.5: 91.40
2017-10-27 18:49:06,711 Epoch took 1624.2814571857452 seconds
2017-10-27 18:49:06,712 epoch = 5
2017-10-27 18:49:06,712 step_size = 0.00013807
2017-10-27 19:15:35,005 Modeling validation data took 149.4742374420166s
2017-10-27 19:15:35,012  5388	~loss(train)=0.3856	loss(valid)=0.3485	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 87.88	Best 1/FPR @ TPR = 0.5: 91.40
2017-10-27 19:15:36,463 Epoch took 1589.7510974407196 seconds
2017-10-27 19:15:36,463 epoch = 6
2017-10-27 19:15:36,463 step_size = 0.00012978
2017-10-27 19:44:02,130 Modeling validation data took 157.75581336021423s
2017-10-27 19:44:02,138  6286	~loss(train)=0.3845	loss(valid)=0.3479	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 88.17	Best 1/FPR @ TPR = 0.5: 91.40
2017-10-27 19:44:03,973 Epoch took 1707.5093367099762 seconds
2017-10-27 19:44:03,973 epoch = 7
2017-10-27 19:44:03,973 step_size = 0.00012200
2017-10-27 20:11:21,664 Modeling validation data took 154.7844512462616s
2017-10-27 20:11:21,670  7184	~loss(train)=0.3839	loss(valid)=0.3474	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 84.56	Best 1/FPR @ TPR = 0.5: 91.40
2017-10-27 20:11:23,507 Epoch took 1639.5339093208313 seconds
2017-10-27 20:11:23,507 epoch = 8
2017-10-27 20:11:23,507 step_size = 0.00011468
2017-10-27 20:40:37,824 Modeling validation data took 164.48854851722717s
2017-10-27 20:40:37,831  8082	~loss(train)=0.3826	loss(valid)=0.3468	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 90.40	Best 1/FPR @ TPR = 0.5: 91.40
2017-10-27 20:40:40,023 Epoch took 1756.5156183242798 seconds
2017-10-27 20:40:40,023 epoch = 9
2017-10-27 20:40:40,024 step_size = 0.00010780
2017-10-27 21:07:57,684 Modeling validation data took 162.84042358398438s
2017-10-27 21:07:57,692  8980	~loss(train)=0.3833	loss(valid)=0.3469	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 95.15	Best 1/FPR @ TPR = 0.5: 95.15
2017-10-27 21:07:59,184 Epoch took 1639.1606109142303 seconds
2017-10-27 21:07:59,184 epoch = 10
2017-10-27 21:07:59,185 step_size = 0.00010133
2017-10-27 21:36:46,036 Modeling validation data took 159.16001868247986s
2017-10-27 21:36:46,042  9878	~loss(train)=0.3818	loss(valid)=0.3473	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 80.16	Best 1/FPR @ TPR = 0.5: 95.15
2017-10-27 21:36:47,866 Epoch took 1728.6808776855469 seconds
2017-10-27 21:36:47,866 epoch = 11
2017-10-27 21:36:47,866 step_size = 0.00009525
2017-10-27 22:06:37,021 Modeling validation data took 177.49671339988708s
2017-10-27 22:06:37,029 10776	~loss(train)=0.3825	loss(valid)=0.3476	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 95.36	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-27 22:06:39,239 Epoch took 1791.3727765083313 seconds
2017-10-27 22:06:39,239 epoch = 12
2017-10-27 22:06:39,239 step_size = 0.00008953
2017-10-27 22:35:40,222 Modeling validation data took 162.09267735481262s
2017-10-27 22:35:40,229 11674	~loss(train)=0.3833	loss(valid)=0.3483	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 82.61	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-27 22:35:41,748 Epoch took 1742.509301185608 seconds
2017-10-27 22:35:41,749 epoch = 13
2017-10-27 22:35:41,749 step_size = 0.00008416
2017-10-27 23:04:30,394 Modeling validation data took 156.5341498851776s
2017-10-27 23:04:30,401 12572	~loss(train)=0.3811	loss(valid)=0.3470	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 81.37	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-27 23:04:32,237 Epoch took 1730.4883313179016 seconds
2017-10-27 23:04:32,237 epoch = 14
2017-10-27 23:04:32,237 step_size = 0.00007911
2017-10-27 23:34:25,089 Modeling validation data took 157.5031430721283s
2017-10-27 23:34:25,106 13470	~loss(train)=0.3829	loss(valid)=0.3472	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 88.79	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-27 23:34:26,817 Epoch took 1794.5792169570923 seconds
2017-10-27 23:34:26,817 epoch = 15
2017-10-27 23:34:26,817 step_size = 0.00007437
2017-10-28 00:04:00,567 Modeling validation data took 163.5665271282196s
2017-10-28 00:04:00,600 14368	~loss(train)=0.3813	loss(valid)=0.3471	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 82.95	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-28 00:04:02,306 Epoch took 1775.488842010498 seconds
2017-10-28 00:04:02,306 epoch = 16
2017-10-28 00:04:02,306 step_size = 0.00006990
2017-10-28 00:33:17,352 Modeling validation data took 169.69381642341614s
2017-10-28 00:33:17,416 15266	~loss(train)=0.3810	loss(valid)=0.3483	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 76.73	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-28 00:33:18,737 Epoch took 1756.4309689998627 seconds
2017-10-28 00:33:18,738 epoch = 17
2017-10-28 00:33:18,738 step_size = 0.00006571
2017-10-28 01:02:19,672 Modeling validation data took 165.4386568069458s
2017-10-28 01:02:19,715 16164	~loss(train)=0.3816	loss(valid)=0.3483	roc_auc(valid)=0.9219	1/FPR @ TPR = 0.5: 83.08	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-28 01:02:20,898 Epoch took 1742.159917831421 seconds
2017-10-28 01:02:20,898 epoch = 18
2017-10-28 01:02:20,898 step_size = 0.00006177
2017-10-28 01:31:08,254 Modeling validation data took 176.9215748310089s
2017-10-28 01:31:08,275 17062	~loss(train)=0.3813	loss(valid)=0.3476	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 79.03	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-28 01:31:10,252 Epoch took 1729.3536205291748 seconds
2017-10-28 01:31:10,252 epoch = 19
2017-10-28 01:31:10,252 step_size = 0.00005806
2017-10-28 01:59:43,789 Modeling validation data took 163.51934576034546s
2017-10-28 01:59:43,822 17960	~loss(train)=0.3801	loss(valid)=0.3468	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 93.93	Best 1/FPR @ TPR = 0.5: 95.36
2017-10-28 01:59:45,613 Epoch took 1715.3612685203552 seconds
2017-10-28 01:59:45,614 FINISHED TRAINING
2017-10-28 01:59:45,614 Results in models/MPNN/set/Oct-27/16-33-37_5
2017-10-28 01:59:45,614 COMPLETED on Oct-28 at 01:59:45
2017-10-28 01:59:46,820 SENT EMAIL
