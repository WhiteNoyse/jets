2017-10-27 19:05:57,531 models/MPNN/set/Oct-27/19-05-57_7/log.txt
2017-10-27 19:05:57,531 models/MPNN/set/Oct-27/19-05-57_7
2017-10-27 19:05:57,533 Logfile at models/MPNN/set/Oct-27/19-05-57_7/log.txt
2017-10-27 19:05:57,533 	batch_size = 100
2017-10-27 19:05:57,533 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 19:05:57,533 	debug = False
2017-10-27 19:05:57,533 	decay = 0.94
2017-10-27 19:05:57,533 	dont_add_cropped = False
2017-10-27 19:05:57,533 	epochs = 20
2017-10-27 19:05:57,534 	extra_tag = 7
2017-10-27 19:05:57,534 	features = 7
2017-10-27 19:05:57,534 	filename = antikt-kt
2017-10-27 19:05:57,534 	gpu = 0
2017-10-27 19:05:57,534 	hidden = 40
2017-10-27 19:05:57,534 	iters = 1
2017-10-27 19:05:57,534 	leaves = True
2017-10-27 19:05:57,534 	load = /home/ih692/jets/models/MPNN/set/Oct-26/7
2017-10-27 19:05:57,534 	model_type = 7
2017-10-27 19:05:57,534 	n_train = -1
2017-10-27 19:05:57,535 	n_valid = 27000
2017-10-27 19:05:57,535 	not_leaves = False
2017-10-27 19:05:57,535 	password = deeplearning
2017-10-27 19:05:57,535 	recipient = henrion@nyu.edu
2017-10-27 19:05:57,535 	restart = True
2017-10-27 19:05:57,535 	seed = 49679
2017-10-27 19:05:57,535 	sender = results74207281@gmail.com
2017-10-27 19:05:57,535 	silent = True
2017-10-27 19:05:57,535 	step_size = 0.001
2017-10-27 19:05:57,535 	verbose = False
2017-10-27 19:05:57,536 	PID = 15545
2017-10-27 19:05:57,536 	Not running on GPU
2017-10-27 19:05:57,536 Loading data...
2017-10-27 19:05:57,538 TF already computed. Loading it.
2017-10-27 19:06:01,783 Data loaded and already preprocessed
2017-10-27 19:06:06,995 Splitting into train and validation...
2017-10-27 19:06:07,020 	raw train size = 73000
2017-10-27 19:06:07,020 	raw valid size = 27000
2017-10-27 19:06:07,020 Cropping...
2017-10-27 19:06:09,821 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 19:06:16,608 	final train size = 89813
2017-10-27 19:06:16,608 	final valid size = 10187
2017-10-27 19:06:16,608 Initializing model...
2017-10-27 19:06:16,638 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2Set (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 19:06:16,639 Number of parameters: 41523
2017-10-27 19:06:16,639 Building optimizer...
2017-10-27 19:06:16,643 Training...
2017-10-27 19:06:16,643 epoch = 0
2017-10-27 19:06:16,643 step_size = 0.00030862
2017-10-27 19:30:42,775 Modeling validation data took 145.3987283706665s
2017-10-27 19:30:42,784   898	~loss(train)=0.3920	loss(valid)=0.3468	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 88.21	Best 1/FPR @ TPR = 0.5: 88.21
2017-10-27 19:30:44,004 Epoch took 1467.3607001304626 seconds
2017-10-27 19:30:44,004 epoch = 1
2017-10-27 19:30:44,004 step_size = 0.00029011
2017-10-27 19:55:33,354 Modeling validation data took 145.1366400718689s
2017-10-27 19:55:33,360  1796	~loss(train)=0.3930	loss(valid)=0.3479	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 78.59	Best 1/FPR @ TPR = 0.5: 88.21
2017-10-27 19:55:34,485 Epoch took 1490.4803240299225 seconds
2017-10-27 19:55:34,485 epoch = 2
2017-10-27 19:55:34,485 step_size = 0.00027270
2017-10-27 20:19:49,257 Modeling validation data took 145.4233202934265s
2017-10-27 20:19:49,266  2694	~loss(train)=0.3904	loss(valid)=0.3480	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 89.29	Best 1/FPR @ TPR = 0.5: 89.29
2017-10-27 20:19:51,132 Epoch took 1456.6473853588104 seconds
2017-10-27 20:19:51,133 epoch = 3
2017-10-27 20:19:51,133 step_size = 0.00025634
2017-10-27 20:44:31,617 Modeling validation data took 145.52416443824768s
2017-10-27 20:44:31,624  3592	~loss(train)=0.3899	loss(valid)=0.3474	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 80.56	Best 1/FPR @ TPR = 0.5: 89.29
2017-10-27 20:44:33,087 Epoch took 1481.9546391963959 seconds
2017-10-27 20:44:33,088 epoch = 4
2017-10-27 20:44:33,088 step_size = 0.00024096
2017-10-27 21:09:00,586 Modeling validation data took 145.7727427482605s
2017-10-27 21:09:00,595  4490	~loss(train)=0.3893	loss(valid)=0.3492	roc_auc(valid)=0.9214	1/FPR @ TPR = 0.5: 90.27	Best 1/FPR @ TPR = 0.5: 90.27
2017-10-27 21:09:02,433 Epoch took 1469.3454921245575 seconds
2017-10-27 21:09:02,434 epoch = 5
2017-10-27 21:09:02,434 step_size = 0.00022650
2017-10-27 21:33:14,799 Modeling validation data took 145.7314248085022s
2017-10-27 21:33:14,806  5388	~loss(train)=0.3892	loss(valid)=0.3465	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 87.09	Best 1/FPR @ TPR = 0.5: 90.27
2017-10-27 21:33:15,929 Epoch took 1453.4951388835907 seconds
2017-10-27 21:33:15,929 epoch = 6
2017-10-27 21:33:15,929 step_size = 0.00021291
2017-10-27 21:57:35,233 Modeling validation data took 145.47376012802124s
2017-10-27 21:57:35,240  6286	~loss(train)=0.3906	loss(valid)=0.3511	roc_auc(valid)=0.9215	1/FPR @ TPR = 0.5: 80.99	Best 1/FPR @ TPR = 0.5: 90.27
2017-10-27 21:57:36,601 Epoch took 1460.671884059906 seconds
2017-10-27 21:57:36,602 epoch = 7
2017-10-27 21:57:36,602 step_size = 0.00020014
2017-10-27 22:22:01,463 Modeling validation data took 145.67305064201355s
2017-10-27 22:22:01,470  7184	~loss(train)=0.3905	loss(valid)=0.3505	roc_auc(valid)=0.9213	1/FPR @ TPR = 0.5: 71.47	Best 1/FPR @ TPR = 0.5: 90.27
2017-10-27 22:22:02,969 Epoch took 1466.3672387599945 seconds
2017-10-27 22:22:02,969 epoch = 8
2017-10-27 22:22:02,969 step_size = 0.00018813
2017-10-27 22:46:09,757 Modeling validation data took 145.53506541252136s
2017-10-27 22:46:09,766  8082	~loss(train)=0.3886	loss(valid)=0.3495	roc_auc(valid)=0.9208	1/FPR @ TPR = 0.5: 93.88	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-27 22:46:11,561 Epoch took 1448.591162443161 seconds
2017-10-27 22:46:11,561 epoch = 9
2017-10-27 22:46:11,561 step_size = 0.00017684
2017-10-27 23:10:24,379 Modeling validation data took 145.47072172164917s
2017-10-27 23:10:24,387  8980	~loss(train)=0.3868	loss(valid)=0.3448	roc_auc(valid)=0.9231	1/FPR @ TPR = 0.5: 82.73	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-27 23:10:25,714 Epoch took 1454.1530272960663 seconds
2017-10-27 23:10:25,714 epoch = 10
2017-10-27 23:10:25,714 step_size = 0.00016623
2017-10-27 23:34:55,966 Modeling validation data took 145.53323769569397s
2017-10-27 23:34:55,979  9878	~loss(train)=0.3868	loss(valid)=0.3462	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 87.21	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-27 23:34:57,660 Epoch took 1471.9456853866577 seconds
2017-10-27 23:34:57,660 epoch = 11
2017-10-27 23:34:57,660 step_size = 0.00015626
2017-10-27 23:58:58,485 Modeling validation data took 145.76383709907532s
2017-10-27 23:58:58,497 10776	~loss(train)=0.3849	loss(valid)=0.3477	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 90.70	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-27 23:58:59,647 Epoch took 1441.9860434532166 seconds
2017-10-27 23:58:59,647 epoch = 12
2017-10-27 23:58:59,647 step_size = 0.00014688
2017-10-28 00:23:22,846 Modeling validation data took 145.61699414253235s
2017-10-28 00:23:22,867 11674	~loss(train)=0.3880	loss(valid)=0.3465	roc_auc(valid)=0.9232	1/FPR @ TPR = 0.5: 80.46	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-28 00:23:24,305 Epoch took 1464.6581580638885 seconds
2017-10-28 00:23:24,305 epoch = 13
2017-10-28 00:23:24,306 step_size = 0.00013807
2017-10-28 00:48:03,600 Modeling validation data took 145.31935715675354s
2017-10-28 00:48:03,624 12572	~loss(train)=0.3856	loss(valid)=0.3460	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 91.13	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-28 00:48:04,697 Epoch took 1480.3911805152893 seconds
2017-10-28 00:48:04,697 epoch = 14
2017-10-28 00:48:04,697 step_size = 0.00012978
2017-10-28 01:12:25,239 Modeling validation data took 145.63084888458252s
2017-10-28 01:12:25,253 13470	~loss(train)=0.3945	loss(valid)=0.3532	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 84.14	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-28 01:12:26,518 Epoch took 1461.8203916549683 seconds
2017-10-28 01:12:26,518 epoch = 15
2017-10-28 01:12:26,518 step_size = 0.00012200
2017-10-28 01:37:21,713 Modeling validation data took 145.6834065914154s
2017-10-28 01:37:21,730 14368	~loss(train)=0.3870	loss(valid)=0.3470	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 79.38	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-28 01:37:22,967 Epoch took 1496.4488224983215 seconds
2017-10-28 01:37:22,967 epoch = 16
2017-10-28 01:37:22,967 step_size = 0.00011468
2017-10-28 02:01:58,100 Modeling validation data took 145.6635298728943s
2017-10-28 02:01:58,136 15266	~loss(train)=0.3844	loss(valid)=0.3461	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 90.39	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-28 02:01:59,217 Epoch took 1476.2495851516724 seconds
2017-10-28 02:01:59,217 epoch = 17
2017-10-28 02:01:59,217 step_size = 0.00010780
2017-10-28 02:26:18,066 Modeling validation data took 145.60856080055237s
2017-10-28 02:26:18,105 16164	~loss(train)=0.3862	loss(valid)=0.3490	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 84.66	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-28 02:26:19,407 Epoch took 1460.1896007061005 seconds
2017-10-28 02:26:19,407 epoch = 18
2017-10-28 02:26:19,407 step_size = 0.00010133
2017-10-28 02:50:38,338 Modeling validation data took 145.46986532211304s
2017-10-28 02:50:38,352 17062	~loss(train)=0.3864	loss(valid)=0.3474	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 88.34	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-28 02:50:39,706 Epoch took 1460.2989752292633 seconds
2017-10-28 02:50:39,707 epoch = 19
2017-10-28 02:50:39,707 step_size = 0.00009525
2017-10-28 03:15:21,430 Modeling validation data took 148.617201089859s
2017-10-28 03:15:21,452 17960	~loss(train)=0.3864	loss(valid)=0.3472	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 89.10	Best 1/FPR @ TPR = 0.5: 93.88
2017-10-28 03:15:22,762 Epoch took 1483.055495262146 seconds
2017-10-28 03:15:22,763 FINISHED TRAINING
2017-10-28 03:15:22,763 Results in models/MPNN/set/Oct-27/19-05-57_7
2017-10-28 03:15:22,763 COMPLETED on Oct-28 at 03:15:22
2017-10-28 03:15:23,660 SENT EMAIL
