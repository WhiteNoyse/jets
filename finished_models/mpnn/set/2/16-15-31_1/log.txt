2017-10-27 16:15:31,202 models/MPNN/set/Oct-27/16-15-31_1/log.txt
2017-10-27 16:15:31,202 models/MPNN/set/Oct-27/16-15-31_1
2017-10-27 16:15:31,203 Logfile at models/MPNN/set/Oct-27/16-15-31_1/log.txt
2017-10-27 16:15:31,203 	batch_size = 100
2017-10-27 16:15:31,203 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 16:15:31,203 	debug = False
2017-10-27 16:15:31,203 	decay = 0.94
2017-10-27 16:15:31,203 	dont_add_cropped = False
2017-10-27 16:15:31,203 	epochs = 20
2017-10-27 16:15:31,203 	extra_tag = 1
2017-10-27 16:15:31,203 	features = 7
2017-10-27 16:15:31,203 	filename = antikt-kt
2017-10-27 16:15:31,203 	gpu = 0
2017-10-27 16:15:31,203 	hidden = 40
2017-10-27 16:15:31,203 	iters = 1
2017-10-27 16:15:31,203 	leaves = True
2017-10-27 16:15:31,203 	load = /home/ih692/jets/models/MPNN/set/Oct-26/1
2017-10-27 16:15:31,203 	model_type = 7
2017-10-27 16:15:31,203 	n_train = -1
2017-10-27 16:15:31,203 	n_valid = 27000
2017-10-27 16:15:31,204 	not_leaves = False
2017-10-27 16:15:31,204 	password = deeplearning
2017-10-27 16:15:31,204 	recipient = henrion@nyu.edu
2017-10-27 16:15:31,204 	restart = True
2017-10-27 16:15:31,204 	seed = 39082
2017-10-27 16:15:31,204 	sender = results74207281@gmail.com
2017-10-27 16:15:31,204 	silent = True
2017-10-27 16:15:31,204 	step_size = 0.001
2017-10-27 16:15:31,204 	verbose = False
2017-10-27 16:15:31,204 	PID = 7450
2017-10-27 16:15:31,204 	Not running on GPU
2017-10-27 16:15:31,204 Loading data...
2017-10-27 16:15:31,205 TF already computed. Loading it.
2017-10-27 16:15:33,025 Data loaded and already preprocessed
2017-10-27 16:15:38,492 Splitting into train and validation...
2017-10-27 16:15:38,520 	raw train size = 73000
2017-10-27 16:15:38,520 	raw valid size = 27000
2017-10-27 16:15:38,521 Cropping...
2017-10-27 16:15:41,109 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 16:15:48,442 	final train size = 89813
2017-10-27 16:15:48,443 	final valid size = 10187
2017-10-27 16:15:48,443 Initializing model...
2017-10-27 16:15:48,486 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2Set (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 16:15:48,487 Number of parameters: 41523
2017-10-27 16:15:48,487 Building optimizer...
2017-10-27 16:15:48,490 Training...
2017-10-27 16:15:48,490 epoch = 0
2017-10-27 16:15:48,490 step_size = 0.00016623
2017-10-27 16:42:59,945 Modeling validation data took 156.85742783546448s
2017-10-27 16:42:59,954   898	~loss(train)=0.3849	loss(valid)=0.3457	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 88.28	Best 1/FPR @ TPR = 0.5: 88.28
2017-10-27 16:43:01,259 Epoch took 1632.7690172195435 seconds
2017-10-27 16:43:01,260 epoch = 1
2017-10-27 16:43:01,260 step_size = 0.00015626
2017-10-27 17:10:53,298 Modeling validation data took 163.94756293296814s
2017-10-27 17:10:53,307  1796	~loss(train)=0.3848	loss(valid)=0.3462	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 88.43	Best 1/FPR @ TPR = 0.5: 88.43
2017-10-27 17:10:54,844 Epoch took 1673.5841209888458 seconds
2017-10-27 17:10:54,844 epoch = 2
2017-10-27 17:10:54,844 step_size = 0.00014688
2017-10-27 17:39:45,695 Modeling validation data took 165.17531847953796s
2017-10-27 17:39:45,733  2694	~loss(train)=0.3856	loss(valid)=0.3476	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 91.07	Best 1/FPR @ TPR = 0.5: 91.07
2017-10-27 17:39:47,586 Epoch took 1732.741651058197 seconds
2017-10-27 17:39:47,586 epoch = 3
2017-10-27 17:39:47,586 step_size = 0.00013807
2017-10-27 18:08:00,417 Modeling validation data took 163.4439651966095s
2017-10-27 18:08:00,426  3592	~loss(train)=0.3837	loss(valid)=0.3466	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 91.61	Best 1/FPR @ TPR = 0.5: 91.61
2017-10-27 18:08:01,827 Epoch took 1694.240966796875 seconds
2017-10-27 18:08:01,828 epoch = 4
2017-10-27 18:08:01,828 step_size = 0.00012978
2017-10-27 18:37:39,567 Modeling validation data took 164.8779239654541s
2017-10-27 18:37:39,575  4490	~loss(train)=0.3849	loss(valid)=0.3466	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 93.76	Best 1/FPR @ TPR = 0.5: 93.76
2017-10-27 18:37:41,259 Epoch took 1779.431474685669 seconds
2017-10-27 18:37:41,259 epoch = 5
2017-10-27 18:37:41,260 step_size = 0.00012200
2017-10-27 19:07:16,142 Modeling validation data took 165.73212218284607s
2017-10-27 19:07:16,151  5388	~loss(train)=0.3840	loss(valid)=0.3469	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 98.31	Best 1/FPR @ TPR = 0.5: 98.31
2017-10-27 19:07:17,905 Epoch took 1776.6457135677338 seconds
2017-10-27 19:07:17,906 epoch = 6
2017-10-27 19:07:17,906 step_size = 0.00011468
2017-10-27 19:37:00,525 Modeling validation data took 173.02410650253296s
2017-10-27 19:37:00,531  6286	~loss(train)=0.3840	loss(valid)=0.3469	roc_auc(valid)=0.9228	1/FPR @ TPR = 0.5: 93.59	Best 1/FPR @ TPR = 0.5: 98.31
2017-10-27 19:37:01,954 Epoch took 1784.0483331680298 seconds
2017-10-27 19:37:01,954 epoch = 7
2017-10-27 19:37:01,954 step_size = 0.00010780
2017-10-27 20:07:29,823 Modeling validation data took 168.80880093574524s
2017-10-27 20:07:29,829  7184	~loss(train)=0.3826	loss(valid)=0.3451	roc_auc(valid)=0.9231	1/FPR @ TPR = 0.5: 91.38	Best 1/FPR @ TPR = 0.5: 98.31
2017-10-27 20:07:31,455 Epoch took 1829.500459909439 seconds
2017-10-27 20:07:31,455 epoch = 8
2017-10-27 20:07:31,455 step_size = 0.00010133
2017-10-27 20:36:40,299 Modeling validation data took 164.93859553337097s
2017-10-27 20:36:40,308  8082	~loss(train)=0.3839	loss(valid)=0.3456	roc_auc(valid)=0.9232	1/FPR @ TPR = 0.5: 100.66	Best 1/FPR @ TPR = 0.5: 100.66
2017-10-27 20:36:42,274 Epoch took 1750.818989276886 seconds
2017-10-27 20:36:42,275 epoch = 9
2017-10-27 20:36:42,275 step_size = 0.00009525
2017-10-27 21:05:09,248 Modeling validation data took 166.66046619415283s
2017-10-27 21:05:09,257  8980	~loss(train)=0.3841	loss(valid)=0.3472	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 102.31	Best 1/FPR @ TPR = 0.5: 102.31
2017-10-27 21:05:11,089 Epoch took 1708.8145470619202 seconds
2017-10-27 21:05:11,090 epoch = 10
2017-10-27 21:05:11,090 step_size = 0.00008953
2017-10-27 21:33:35,988 Modeling validation data took 160.84657526016235s
2017-10-27 21:33:35,994  9878	~loss(train)=0.3823	loss(valid)=0.3465	roc_auc(valid)=0.9228	1/FPR @ TPR = 0.5: 90.82	Best 1/FPR @ TPR = 0.5: 102.31
2017-10-27 21:33:37,729 Epoch took 1706.638861656189 seconds
2017-10-27 21:33:37,729 epoch = 11
2017-10-27 21:33:37,729 step_size = 0.00008416
2017-10-27 22:03:08,449 Modeling validation data took 157.73228883743286s
2017-10-27 22:03:08,455 10776	~loss(train)=0.3832	loss(valid)=0.3464	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 93.57	Best 1/FPR @ TPR = 0.5: 102.31
2017-10-27 22:03:09,844 Epoch took 1772.115093946457 seconds
2017-10-27 22:03:09,845 epoch = 12
2017-10-27 22:03:09,845 step_size = 0.00007911
2017-10-27 22:31:39,324 Modeling validation data took 162.78466725349426s
2017-10-27 22:31:39,331 11674	~loss(train)=0.3829	loss(valid)=0.3464	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 91.94	Best 1/FPR @ TPR = 0.5: 102.31
2017-10-27 22:31:40,615 Epoch took 1710.76984333992 seconds
2017-10-27 22:31:40,615 epoch = 13
2017-10-27 22:31:40,615 step_size = 0.00007437
2017-10-27 23:00:03,490 Modeling validation data took 164.6075050830841s
2017-10-27 23:00:03,496 12572	~loss(train)=0.3813	loss(valid)=0.3457	roc_auc(valid)=0.9233	1/FPR @ TPR = 0.5: 96.00	Best 1/FPR @ TPR = 0.5: 102.31
2017-10-27 23:00:05,570 Epoch took 1704.9551844596863 seconds
2017-10-27 23:00:05,570 epoch = 14
2017-10-27 23:00:05,570 step_size = 0.00006990
2017-10-27 23:32:40,770 Modeling validation data took 164.65936136245728s
2017-10-27 23:32:40,779 13470	~loss(train)=0.3830	loss(valid)=0.3470	roc_auc(valid)=0.9227	1/FPR @ TPR = 0.5: 84.83	Best 1/FPR @ TPR = 0.5: 102.31
2017-10-27 23:32:42,506 Epoch took 1956.93555021286 seconds
2017-10-27 23:32:42,506 epoch = 15
2017-10-27 23:32:42,506 step_size = 0.00006571
2017-10-28 00:06:22,791 Modeling validation data took 201.065288066864s
2017-10-28 00:06:22,839 14368	~loss(train)=0.3815	loss(valid)=0.3458	roc_auc(valid)=0.9228	1/FPR @ TPR = 0.5: 83.53	Best 1/FPR @ TPR = 0.5: 102.31
2017-10-28 00:06:24,494 Epoch took 2021.9874775409698 seconds
2017-10-28 00:06:24,494 epoch = 16
2017-10-28 00:06:24,494 step_size = 0.00006177
2017-10-28 00:37:20,065 Modeling validation data took 164.83160877227783s
2017-10-28 00:37:20,109 15266	~loss(train)=0.3815	loss(valid)=0.3459	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 109.30	Best 1/FPR @ TPR = 0.5: 109.30
2017-10-28 00:37:22,170 Epoch took 1857.6751430034637 seconds
2017-10-28 00:37:22,170 epoch = 17
2017-10-28 00:37:22,170 step_size = 0.00005806
2017-10-28 01:08:28,221 Modeling validation data took 164.732182264328s
2017-10-28 01:08:28,249 16164	~loss(train)=0.3801	loss(valid)=0.3463	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 96.66	Best 1/FPR @ TPR = 0.5: 109.30
2017-10-28 01:08:30,062 Epoch took 1867.891609430313 seconds
2017-10-28 01:08:30,062 epoch = 18
2017-10-28 01:08:30,062 step_size = 0.00005458
2017-10-28 01:39:25,171 Modeling validation data took 171.50447916984558s
2017-10-28 01:39:25,189 17062	~loss(train)=0.3807	loss(valid)=0.3462	roc_auc(valid)=0.9231	1/FPR @ TPR = 0.5: 100.45	Best 1/FPR @ TPR = 0.5: 109.30
2017-10-28 01:39:26,924 Epoch took 1856.8614826202393 seconds
2017-10-28 01:39:26,924 epoch = 19
2017-10-28 01:39:26,924 step_size = 0.00005130
2017-10-28 02:09:41,619 Modeling validation data took 157.58008575439453s
2017-10-28 02:09:41,657 17960	~loss(train)=0.3811	loss(valid)=0.3459	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 95.55	Best 1/FPR @ TPR = 0.5: 109.30
2017-10-28 02:09:42,990 Epoch took 1816.0665402412415 seconds
2017-10-28 02:09:42,991 FINISHED TRAINING
2017-10-28 02:09:42,991 Results in models/MPNN/set/Oct-27/16-15-31_1
2017-10-28 02:09:42,991 COMPLETED on Oct-28 at 02:09:42
2017-10-28 02:09:43,845 SENT EMAIL
