2017-10-27 16:17:30,187 models/MPNN/set/Oct-27/16-17-30_2/log.txt
2017-10-27 16:17:30,188 models/MPNN/set/Oct-27/16-17-30_2
2017-10-27 16:17:30,188 Logfile at models/MPNN/set/Oct-27/16-17-30_2/log.txt
2017-10-27 16:17:30,188 	batch_size = 100
2017-10-27 16:17:30,188 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 16:17:30,188 	debug = False
2017-10-27 16:17:30,188 	decay = 0.94
2017-10-27 16:17:30,188 	dont_add_cropped = False
2017-10-27 16:17:30,188 	epochs = 20
2017-10-27 16:17:30,189 	extra_tag = 2
2017-10-27 16:17:30,189 	features = 7
2017-10-27 16:17:30,189 	filename = antikt-kt
2017-10-27 16:17:30,189 	gpu = 0
2017-10-27 16:17:30,189 	hidden = 40
2017-10-27 16:17:30,189 	iters = 1
2017-10-27 16:17:30,189 	leaves = True
2017-10-27 16:17:30,189 	load = /home/ih692/jets/models/MPNN/set/Oct-26/2
2017-10-27 16:17:30,189 	model_type = 7
2017-10-27 16:17:30,189 	n_train = -1
2017-10-27 16:17:30,189 	n_valid = 27000
2017-10-27 16:17:30,189 	not_leaves = False
2017-10-27 16:17:30,189 	password = deeplearning
2017-10-27 16:17:30,189 	recipient = henrion@nyu.edu
2017-10-27 16:17:30,189 	restart = True
2017-10-27 16:17:30,189 	seed = 21789
2017-10-27 16:17:30,189 	sender = results74207281@gmail.com
2017-10-27 16:17:30,189 	silent = True
2017-10-27 16:17:30,189 	step_size = 0.001
2017-10-27 16:17:30,189 	verbose = False
2017-10-27 16:17:30,189 	PID = 63343
2017-10-27 16:17:30,189 	Not running on GPU
2017-10-27 16:17:30,189 Loading data...
2017-10-27 16:17:30,191 TF already computed. Loading it.
2017-10-27 16:17:32,362 Data loaded and already preprocessed
2017-10-27 16:17:36,017 Splitting into train and validation...
2017-10-27 16:17:36,044 	raw train size = 73000
2017-10-27 16:17:36,044 	raw valid size = 27000
2017-10-27 16:17:36,045 Cropping...
2017-10-27 16:17:39,015 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 16:17:46,989 	final train size = 89813
2017-10-27 16:17:46,989 	final valid size = 10187
2017-10-27 16:17:46,989 Initializing model...
2017-10-27 16:17:47,046 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2Set (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2Set (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 16:17:47,046 Number of parameters: 41523
2017-10-27 16:17:47,047 Building optimizer...
2017-10-27 16:17:47,050 Training...
2017-10-27 16:17:47,050 epoch = 0
2017-10-27 16:17:47,050 step_size = 0.00016623
2017-10-27 16:43:28,466 Modeling validation data took 145.87892484664917s
2017-10-27 16:43:28,475   898	~loss(train)=0.3846	loss(valid)=0.3450	roc_auc(valid)=0.9234	1/FPR @ TPR = 0.5: 102.85	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 16:43:30,232 Epoch took 1543.1823732852936 seconds
2017-10-27 16:43:30,232 epoch = 1
2017-10-27 16:43:30,232 step_size = 0.00015626
2017-10-27 17:09:08,629 Modeling validation data took 143.16705751419067s
2017-10-27 17:09:08,636  1796	~loss(train)=0.3841	loss(valid)=0.3446	roc_auc(valid)=0.9233	1/FPR @ TPR = 0.5: 91.92	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 17:09:10,392 Epoch took 1540.1597230434418 seconds
2017-10-27 17:09:10,393 epoch = 2
2017-10-27 17:09:10,393 step_size = 0.00014688
2017-10-27 17:35:21,849 Modeling validation data took 148.3727376461029s
2017-10-27 17:35:21,864  2694	~loss(train)=0.3832	loss(valid)=0.3449	roc_auc(valid)=0.9235	1/FPR @ TPR = 0.5: 94.51	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 17:35:23,632 Epoch took 1573.23912358284 seconds
2017-10-27 17:35:23,632 epoch = 3
2017-10-27 17:35:23,632 step_size = 0.00013807
2017-10-27 18:00:59,751 Modeling validation data took 146.28573369979858s
2017-10-27 18:00:59,757  3592	~loss(train)=0.3829	loss(valid)=0.3438	roc_auc(valid)=0.9237	1/FPR @ TPR = 0.5: 95.90	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 18:01:01,510 Epoch took 1537.8773365020752 seconds
2017-10-27 18:01:01,510 epoch = 4
2017-10-27 18:01:01,510 step_size = 0.00012978
2017-10-27 18:26:24,252 Modeling validation data took 143.95903158187866s
2017-10-27 18:26:24,258  4490	~loss(train)=0.3828	loss(valid)=0.3449	roc_auc(valid)=0.9234	1/FPR @ TPR = 0.5: 100.85	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 18:26:25,406 Epoch took 1523.8963871002197 seconds
2017-10-27 18:26:25,407 epoch = 5
2017-10-27 18:26:25,407 step_size = 0.00012200
2017-10-27 18:52:43,129 Modeling validation data took 147.45146703720093s
2017-10-27 18:52:43,136  5388	~loss(train)=0.3839	loss(valid)=0.3450	roc_auc(valid)=0.9235	1/FPR @ TPR = 0.5: 98.45	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 18:52:44,338 Epoch took 1578.93097281456 seconds
2017-10-27 18:52:44,338 epoch = 6
2017-10-27 18:52:44,338 step_size = 0.00011468
2017-10-27 19:18:20,154 Modeling validation data took 144.09286165237427s
2017-10-27 19:18:20,160  6286	~loss(train)=0.3836	loss(valid)=0.3443	roc_auc(valid)=0.9234	1/FPR @ TPR = 0.5: 97.99	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 19:18:21,546 Epoch took 1537.207370042801 seconds
2017-10-27 19:18:21,546 epoch = 7
2017-10-27 19:18:21,546 step_size = 0.00010780
2017-10-27 19:44:12,593 Modeling validation data took 148.72514963150024s
2017-10-27 19:44:12,599  7184	~loss(train)=0.3828	loss(valid)=0.3437	roc_auc(valid)=0.9236	1/FPR @ TPR = 0.5: 97.57	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 19:44:14,154 Epoch took 1552.6084234714508 seconds
2017-10-27 19:44:14,155 epoch = 8
2017-10-27 19:44:14,155 step_size = 0.00010133
2017-10-27 20:10:20,761 Modeling validation data took 148.69191098213196s
2017-10-27 20:10:20,768  8082	~loss(train)=0.3827	loss(valid)=0.3441	roc_auc(valid)=0.9237	1/FPR @ TPR = 0.5: 92.88	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 20:10:22,018 Epoch took 1567.8633732795715 seconds
2017-10-27 20:10:22,018 epoch = 9
2017-10-27 20:10:22,018 step_size = 0.00009525
2017-10-27 20:36:09,170 Modeling validation data took 144.35870003700256s
2017-10-27 20:36:09,177  8980	~loss(train)=0.3834	loss(valid)=0.3452	roc_auc(valid)=0.9233	1/FPR @ TPR = 0.5: 95.89	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 20:36:10,563 Epoch took 1548.5445806980133 seconds
2017-10-27 20:36:10,563 epoch = 10
2017-10-27 20:36:10,563 step_size = 0.00008953
2017-10-27 21:02:03,758 Modeling validation data took 145.62130784988403s
2017-10-27 21:02:03,764  9878	~loss(train)=0.3828	loss(valid)=0.3464	roc_auc(valid)=0.9234	1/FPR @ TPR = 0.5: 92.86	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 21:02:05,156 Epoch took 1554.5922439098358 seconds
2017-10-27 21:02:05,156 epoch = 11
2017-10-27 21:02:05,156 step_size = 0.00008416
2017-10-27 21:27:54,218 Modeling validation data took 145.4333906173706s
2017-10-27 21:27:54,224 10776	~loss(train)=0.3813	loss(valid)=0.3445	roc_auc(valid)=0.9238	1/FPR @ TPR = 0.5: 95.37	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 21:27:56,064 Epoch took 1550.907787322998 seconds
2017-10-27 21:27:56,064 epoch = 12
2017-10-27 21:27:56,064 step_size = 0.00007911
2017-10-27 21:54:53,186 Modeling validation data took 152.1454360485077s
2017-10-27 21:54:53,192 11674	~loss(train)=0.3814	loss(valid)=0.3437	roc_auc(valid)=0.9237	1/FPR @ TPR = 0.5: 97.67	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 21:54:54,555 Epoch took 1618.4912056922913 seconds
2017-10-27 21:54:54,556 epoch = 13
2017-10-27 21:54:54,556 step_size = 0.00007437
2017-10-27 22:21:54,221 Modeling validation data took 146.84033250808716s
2017-10-27 22:21:54,227 12572	~loss(train)=0.3830	loss(valid)=0.3473	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 88.20	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 22:21:55,556 Epoch took 1621.000553369522 seconds
2017-10-27 22:21:55,556 epoch = 14
2017-10-27 22:21:55,556 step_size = 0.00006990
2017-10-27 22:49:10,362 Modeling validation data took 145.11510634422302s
2017-10-27 22:49:10,379 13470	~loss(train)=0.3827	loss(valid)=0.3454	roc_auc(valid)=0.9232	1/FPR @ TPR = 0.5: 96.57	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 22:49:11,727 Epoch took 1636.1701865196228 seconds
2017-10-27 22:49:11,727 epoch = 15
2017-10-27 22:49:11,727 step_size = 0.00006571
2017-10-27 23:16:52,449 Modeling validation data took 160.77047872543335s
2017-10-27 23:16:52,474 14368	~loss(train)=0.3805	loss(valid)=0.3438	roc_auc(valid)=0.9236	1/FPR @ TPR = 0.5: 95.51	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 23:16:54,252 Epoch took 1662.524750471115 seconds
2017-10-27 23:16:54,252 epoch = 16
2017-10-27 23:16:54,252 step_size = 0.00006177
2017-10-27 23:44:20,881 Modeling validation data took 159.60771107673645s
2017-10-27 23:44:20,902 15266	~loss(train)=0.3810	loss(valid)=0.3452	roc_auc(valid)=0.9231	1/FPR @ TPR = 0.5: 88.18	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-27 23:44:22,341 Epoch took 1648.0889661312103 seconds
2017-10-27 23:44:22,342 epoch = 17
2017-10-27 23:44:22,342 step_size = 0.00005806
2017-10-28 00:12:25,956 Modeling validation data took 146.5013267993927s
2017-10-28 00:12:25,969 16164	~loss(train)=0.3812	loss(valid)=0.3451	roc_auc(valid)=0.9234	1/FPR @ TPR = 0.5: 85.64	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-28 00:12:27,586 Epoch took 1685.2440383434296 seconds
2017-10-28 00:12:27,586 epoch = 18
2017-10-28 00:12:27,586 step_size = 0.00005458
2017-10-28 00:40:10,596 Modeling validation data took 146.63256335258484s
2017-10-28 00:40:10,622 17062	~loss(train)=0.3805	loss(valid)=0.3457	roc_auc(valid)=0.9234	1/FPR @ TPR = 0.5: 90.92	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-28 00:40:12,215 Epoch took 1664.6291527748108 seconds
2017-10-28 00:40:12,216 epoch = 19
2017-10-28 00:40:12,216 step_size = 0.00005130
2017-10-28 01:08:46,526 Modeling validation data took 161.49733686447144s
2017-10-28 01:08:46,548 17960	~loss(train)=0.3801	loss(valid)=0.3447	roc_auc(valid)=0.9238	1/FPR @ TPR = 0.5: 98.87	Best 1/FPR @ TPR = 0.5: 102.85
2017-10-28 01:08:48,334 Epoch took 1716.1182448863983 seconds
2017-10-28 01:08:48,334 FINISHED TRAINING
2017-10-28 01:08:48,334 Results in models/MPNN/set/Oct-27/16-17-30_2
2017-10-28 01:08:48,335 COMPLETED on Oct-28 at 01:08:48
2017-10-28 01:08:49,211 SENT EMAIL
