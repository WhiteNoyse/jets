2017-10-31 09:43:18,098 models/mpnn/sym-set/2/Oct-31-09-43-17_0/log.txt
2017-10-31 09:43:18,098 models/mpnn/sym-set/2/Oct-31-09-43-17_0
2017-10-31 09:43:18,106 Logfile at models/mpnn/sym-set/2/Oct-31-09-43-17_0/log.txt
2017-10-31 09:43:18,106 	batch_size = 100
2017-10-31 09:43:18,106 	data_dir = data/w-vs-qcd/pickles
2017-10-31 09:43:18,106 	debug = False
2017-10-31 09:43:18,107 	decay = 0.94
2017-10-31 09:43:18,107 	dont_add_cropped = False
2017-10-31 09:43:18,107 	epochs = 50
2017-10-31 09:43:18,107 	extra_tag = 0
2017-10-31 09:43:18,107 	features = 7
2017-10-31 09:43:18,107 	filename = antikt-kt
2017-10-31 09:43:18,107 	gpu = 1
2017-10-31 09:43:18,107 	hidden = 40
2017-10-31 09:43:18,107 	iters = 2
2017-10-31 09:43:18,107 	leaves = True
2017-10-31 09:43:18,107 	load = None
2017-10-31 09:43:18,107 	model_type = 4
2017-10-31 09:43:18,107 	n_train = -1
2017-10-31 09:43:18,107 	n_valid = 27000
2017-10-31 09:43:18,107 	not_leaves = False
2017-10-31 09:43:18,107 	password = deeplearning
2017-10-31 09:43:18,107 	pileup = False
2017-10-31 09:43:18,107 	recipient = henrion@nyu.edu
2017-10-31 09:43:18,107 	restart = False
2017-10-31 09:43:18,107 	root_exp_dir = models/mpnn/sym-set/2
2017-10-31 09:43:18,108 	seed = 17132
2017-10-31 09:43:18,108 	sender = results74207281@gmail.com
2017-10-31 09:43:18,108 	silent = True
2017-10-31 09:43:18,108 	step_size = 0.001
2017-10-31 09:43:18,108 	verbose = False
2017-10-31 09:43:18,108 	PID = 13356
2017-10-31 09:43:18,108 	Running on GPU
2017-10-31 09:43:18,108 Loading data...
2017-10-31 09:43:18,109 TF already computed. Loading it.
2017-10-31 09:43:25,880 Data loaded and already preprocessed
2017-10-31 09:43:32,411 Splitting into train and validation...
2017-10-31 09:43:32,441 	raw train size = 73000
2017-10-31 09:43:32,441 	raw valid size = 27000
2017-10-31 09:43:32,441 Cropping...
2017-10-31 09:43:35,453 10187 (selected) + 16813 (cropped) = 27000
2017-10-31 09:43:43,937 	final train size = 89813
2017-10-31 09:43:43,938 	final valid size = 10187
2017-10-31 09:43:43,938 Initializing model...
2017-10-31 09:43:43,940 PredictFromParticleEmbedding (
  (transform): MPNNTransformSet2SetSymmetric (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPSet2SetSymmetric (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPSet2SetSymmetric (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (88 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-31 09:43:43,942 Number of parameters: 41523
2017-10-31 09:43:43,942 Moving model to GPU
2017-10-31 09:43:46,143 Moved model to GPU
2017-10-31 09:43:46,144 Building optimizer...
2017-10-31 09:43:46,173 Training...
2017-10-31 09:43:46,173 epoch = 0
2017-10-31 09:43:46,173 step_size = 0.00100000
2017-10-31 09:59:09,419 Modeling validation data took 154.63415479660034s
2017-10-31 09:59:09,434   898	~loss(train)=0.4469	loss(valid)=0.3858	roc_auc(valid)=0.9076	1/FPR @ TPR = 0.5: 39.21	Best 1/FPR @ TPR = 0.5: 39.21
2017-10-31 09:59:10,275 Epoch took 924.1018102169037 seconds
2017-10-31 09:59:10,275 epoch = 1
2017-10-31 09:59:10,275 step_size = 0.00094000
2017-10-31 10:14:34,640 Modeling validation data took 152.7554051876068s
2017-10-31 10:14:34,655  1796	~loss(train)=0.4367	loss(valid)=0.3700	roc_auc(valid)=0.9119	1/FPR @ TPR = 0.5: 55.14	Best 1/FPR @ TPR = 0.5: 55.14
2017-10-31 10:14:35,576 Epoch took 925.300657749176 seconds
2017-10-31 10:14:35,576 epoch = 2
2017-10-31 10:14:35,576 step_size = 0.00088360
2017-10-31 10:29:56,420 Modeling validation data took 152.55681562423706s
2017-10-31 10:29:56,435  2694	~loss(train)=0.4140	loss(valid)=0.3670	roc_auc(valid)=0.9148	1/FPR @ TPR = 0.5: 63.27	Best 1/FPR @ TPR = 0.5: 63.27
2017-10-31 10:29:57,251 Epoch took 921.674905538559 seconds
2017-10-31 10:29:57,252 epoch = 3
2017-10-31 10:29:57,252 step_size = 0.00083058
2017-10-31 10:45:16,492 Modeling validation data took 152.33358573913574s
2017-10-31 10:45:16,501  3592	~loss(train)=0.4193	loss(valid)=0.3702	roc_auc(valid)=0.9145	1/FPR @ TPR = 0.5: 59.15	Best 1/FPR @ TPR = 0.5: 63.27
2017-10-31 10:45:17,289 Epoch took 920.0371420383453 seconds
2017-10-31 10:45:17,289 epoch = 4
2017-10-31 10:45:17,289 step_size = 0.00078075
2017-10-31 11:00:40,817 Modeling validation data took 153.9235758781433s
2017-10-31 11:00:40,831  4490	~loss(train)=0.4150	loss(valid)=0.3678	roc_auc(valid)=0.9163	1/FPR @ TPR = 0.5: 70.62	Best 1/FPR @ TPR = 0.5: 70.62
2017-10-31 11:00:41,792 Epoch took 924.5024371147156 seconds
2017-10-31 11:00:41,792 epoch = 5
2017-10-31 11:00:41,792 step_size = 0.00073390
2017-10-31 11:16:09,770 Modeling validation data took 155.07932114601135s
2017-10-31 11:16:09,784  5388	~loss(train)=0.4291	loss(valid)=0.3676	roc_auc(valid)=0.9156	1/FPR @ TPR = 0.5: 71.12	Best 1/FPR @ TPR = 0.5: 71.12
2017-10-31 11:16:10,444 Epoch took 928.6521534919739 seconds
2017-10-31 11:16:10,444 epoch = 6
2017-10-31 11:16:10,445 step_size = 0.00068987
2017-10-31 11:31:38,371 Modeling validation data took 152.08504104614258s
2017-10-31 11:31:38,380  6286	~loss(train)=0.4076	loss(valid)=0.3598	roc_auc(valid)=0.9166	1/FPR @ TPR = 0.5: 63.47	Best 1/FPR @ TPR = 0.5: 71.12
2017-10-31 11:31:39,230 Epoch took 928.7857294082642 seconds
2017-10-31 11:31:39,231 epoch = 7
2017-10-31 11:31:39,231 step_size = 0.00064848
2017-10-31 11:47:16,416 Modeling validation data took 155.8173108100891s
2017-10-31 11:47:16,425  7184	~loss(train)=0.4067	loss(valid)=0.3602	roc_auc(valid)=0.9166	1/FPR @ TPR = 0.5: 62.66	Best 1/FPR @ TPR = 0.5: 71.12
2017-10-31 11:47:17,338 Epoch took 938.1070501804352 seconds
2017-10-31 11:47:17,338 epoch = 8
2017-10-31 11:47:17,338 step_size = 0.00060957
2017-10-31 12:02:37,642 Modeling validation data took 153.6023211479187s
2017-10-31 12:02:37,656  8082	~loss(train)=0.4056	loss(valid)=0.3554	roc_auc(valid)=0.9182	1/FPR @ TPR = 0.5: 72.59	Best 1/FPR @ TPR = 0.5: 72.59
2017-10-31 12:02:38,598 Epoch took 921.2600965499878 seconds
2017-10-31 12:02:38,599 epoch = 9
2017-10-31 12:02:38,599 step_size = 0.00057299
2017-10-31 12:17:57,745 Modeling validation data took 153.76016283035278s
2017-10-31 12:17:57,754  8980	~loss(train)=0.4069	loss(valid)=0.3623	roc_auc(valid)=0.9163	1/FPR @ TPR = 0.5: 63.78	Best 1/FPR @ TPR = 0.5: 72.59
2017-10-31 12:17:58,684 Epoch took 920.0855412483215 seconds
2017-10-31 12:17:58,685 epoch = 10
2017-10-31 12:17:58,685 step_size = 0.00053862
2017-10-31 12:33:24,502 Modeling validation data took 154.5804102420807s
2017-10-31 12:33:24,511  9878	~loss(train)=0.4053	loss(valid)=0.3591	roc_auc(valid)=0.9187	1/FPR @ TPR = 0.5: 70.76	Best 1/FPR @ TPR = 0.5: 72.59
2017-10-31 12:33:25,649 Epoch took 926.9647738933563 seconds
2017-10-31 12:33:25,650 epoch = 11
2017-10-31 12:33:25,650 step_size = 0.00050630
2017-10-31 12:48:48,898 Modeling validation data took 154.01874041557312s
2017-10-31 12:48:48,907 10776	~loss(train)=0.4080	loss(valid)=0.3597	roc_auc(valid)=0.9167	1/FPR @ TPR = 0.5: 50.74	Best 1/FPR @ TPR = 0.5: 72.59
2017-10-31 12:48:49,809 Epoch took 924.1596279144287 seconds
2017-10-31 12:48:49,810 epoch = 12
2017-10-31 12:48:49,810 step_size = 0.00047592
2017-10-31 13:04:22,811 Modeling validation data took 153.6481626033783s
2017-10-31 13:04:22,826 11674	~loss(train)=0.4052	loss(valid)=0.3563	roc_auc(valid)=0.9182	1/FPR @ TPR = 0.5: 75.42	Best 1/FPR @ TPR = 0.5: 75.42
2017-10-31 13:04:23,681 Epoch took 933.870733499527 seconds
2017-10-31 13:04:23,681 epoch = 13
2017-10-31 13:04:23,681 step_size = 0.00044737
2017-10-31 13:19:47,329 Modeling validation data took 154.08903980255127s
2017-10-31 13:19:47,338 12572	~loss(train)=0.4020	loss(valid)=0.3532	roc_auc(valid)=0.9197	1/FPR @ TPR = 0.5: 74.63	Best 1/FPR @ TPR = 0.5: 75.42
2017-10-31 13:19:48,041 Epoch took 924.3602635860443 seconds
2017-10-31 13:19:48,042 epoch = 14
2017-10-31 13:19:48,042 step_size = 0.00042052
2017-10-31 13:35:17,898 Modeling validation data took 154.4485912322998s
2017-10-31 13:35:17,913 13470	~loss(train)=0.3984	loss(valid)=0.3543	roc_auc(valid)=0.9194	1/FPR @ TPR = 0.5: 75.95	Best 1/FPR @ TPR = 0.5: 75.95
2017-10-31 13:35:18,842 Epoch took 930.8004553318024 seconds
2017-10-31 13:35:18,842 epoch = 15
2017-10-31 13:35:18,842 step_size = 0.00039529
2017-10-31 13:50:42,243 Modeling validation data took 153.07736539840698s
2017-10-31 13:50:42,252 14368	~loss(train)=0.4004	loss(valid)=0.3582	roc_auc(valid)=0.9195	1/FPR @ TPR = 0.5: 69.65	Best 1/FPR @ TPR = 0.5: 75.95
2017-10-31 13:50:43,147 Epoch took 924.3043155670166 seconds
2017-10-31 13:50:43,147 epoch = 16
2017-10-31 13:50:43,147 step_size = 0.00037157
2017-10-31 14:06:09,738 Modeling validation data took 154.7329866886139s
2017-10-31 14:06:09,747 15266	~loss(train)=0.3985	loss(valid)=0.3525	roc_auc(valid)=0.9207	1/FPR @ TPR = 0.5: 69.38	Best 1/FPR @ TPR = 0.5: 75.95
2017-10-31 14:06:10,631 Epoch took 927.4833347797394 seconds
2017-10-31 14:06:10,631 epoch = 17
2017-10-31 14:06:10,631 step_size = 0.00034928
2017-10-31 14:21:20,398 Modeling validation data took 149.96140384674072s
2017-10-31 14:21:20,406 16164	~loss(train)=0.3962	loss(valid)=0.3524	roc_auc(valid)=0.9212	1/FPR @ TPR = 0.5: 74.92	Best 1/FPR @ TPR = 0.5: 75.95
2017-10-31 14:21:21,261 Epoch took 910.6297788619995 seconds
2017-10-31 14:21:21,261 epoch = 18
2017-10-31 14:21:21,261 step_size = 0.00032832
2017-10-31 14:36:30,702 Modeling validation data took 152.8944582939148s
2017-10-31 14:36:30,710 17062	~loss(train)=0.3981	loss(valid)=0.3540	roc_auc(valid)=0.9189	1/FPR @ TPR = 0.5: 65.96	Best 1/FPR @ TPR = 0.5: 75.95
2017-10-31 14:36:31,728 Epoch took 910.4672517776489 seconds
2017-10-31 14:36:31,729 epoch = 19
2017-10-31 14:36:31,729 step_size = 0.00030862
2017-10-31 14:51:44,307 Modeling validation data took 149.64402794837952s
2017-10-31 14:51:44,316 17960	~loss(train)=0.3993	loss(valid)=0.3529	roc_auc(valid)=0.9210	1/FPR @ TPR = 0.5: 71.06	Best 1/FPR @ TPR = 0.5: 75.95
2017-10-31 14:51:45,191 Epoch took 913.4623019695282 seconds
2017-10-31 14:51:45,191 epoch = 20
2017-10-31 14:51:45,191 step_size = 0.00029011
2017-10-31 15:06:58,039 Modeling validation data took 152.2051649093628s
2017-10-31 15:06:58,048 18858	~loss(train)=0.3975	loss(valid)=0.3525	roc_auc(valid)=0.9202	1/FPR @ TPR = 0.5: 65.17	Best 1/FPR @ TPR = 0.5: 75.95
2017-10-31 15:06:58,874 Epoch took 913.6826682090759 seconds
2017-10-31 15:06:58,874 epoch = 21
2017-10-31 15:06:58,875 step_size = 0.00027270
2017-10-31 15:22:13,607 Modeling validation data took 150.89824438095093s
2017-10-31 15:22:13,616 19756	~loss(train)=0.3970	loss(valid)=0.3543	roc_auc(valid)=0.9200	1/FPR @ TPR = 0.5: 68.50	Best 1/FPR @ TPR = 0.5: 75.95
2017-10-31 15:22:14,705 Epoch took 915.8298931121826 seconds
2017-10-31 15:22:14,705 epoch = 22
2017-10-31 15:22:14,705 step_size = 0.00025634
2017-10-31 15:37:34,020 Modeling validation data took 153.72004652023315s
2017-10-31 15:37:34,035 20654	~loss(train)=0.3938	loss(valid)=0.3521	roc_auc(valid)=0.9208	1/FPR @ TPR = 0.5: 78.16	Best 1/FPR @ TPR = 0.5: 78.16
2017-10-31 15:37:35,037 Epoch took 920.3320918083191 seconds
2017-10-31 15:37:35,037 epoch = 23
2017-10-31 15:37:35,037 step_size = 0.00024096
2017-10-31 15:52:41,600 Modeling validation data took 151.53291416168213s
2017-10-31 15:52:41,615 21552	~loss(train)=0.3968	loss(valid)=0.3521	roc_auc(valid)=0.9210	1/FPR @ TPR = 0.5: 88.49	Best 1/FPR @ TPR = 0.5: 88.49
2017-10-31 15:52:42,398 Epoch took 907.3608484268188 seconds
2017-10-31 15:52:42,398 epoch = 24
2017-10-31 15:52:42,399 step_size = 0.00022650
2017-10-31 16:07:45,040 Modeling validation data took 151.13628458976746s
2017-10-31 16:07:45,050 22450	~loss(train)=0.3972	loss(valid)=0.3553	roc_auc(valid)=0.9210	1/FPR @ TPR = 0.5: 78.66	Best 1/FPR @ TPR = 0.5: 88.49
2017-10-31 16:07:45,942 Epoch took 903.5433087348938 seconds
2017-10-31 16:07:45,942 epoch = 25
2017-10-31 16:07:45,942 step_size = 0.00021291
2017-10-31 16:22:57,804 Modeling validation data took 149.22806882858276s
2017-10-31 16:22:57,819 23348	~loss(train)=0.3971	loss(valid)=0.3545	roc_auc(valid)=0.9203	1/FPR @ TPR = 0.5: 100.88	Best 1/FPR @ TPR = 0.5: 100.88
2017-10-31 16:22:58,696 Epoch took 912.7532196044922 seconds
2017-10-31 16:22:58,696 epoch = 26
2017-10-31 16:22:58,696 step_size = 0.00020014
2017-10-31 16:25:46,354 KILLED on Oct-31 at 16:25:46
2017-10-31 16:25:47,444 SENT EMAIL
