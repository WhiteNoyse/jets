2017-10-27 14:52:09,282 models/MPNN/adaptive/Oct-27/14-52-09_3/log.txt
2017-10-27 14:52:09,283 models/MPNN/adaptive/Oct-27/14-52-09_3
2017-10-27 14:52:09,284 Logfile at models/MPNN/adaptive/Oct-27/14-52-09_3/log.txt
2017-10-27 14:52:09,284 	batch_size = 100
2017-10-27 14:52:09,284 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 14:52:09,284 	debug = False
2017-10-27 14:52:09,284 	decay = 0.94
2017-10-27 14:52:09,284 	dont_add_cropped = False
2017-10-27 14:52:09,284 	epochs = 20
2017-10-27 14:52:09,284 	extra_tag = 3
2017-10-27 14:52:09,284 	features = 7
2017-10-27 14:52:09,284 	filename = antikt-kt
2017-10-27 14:52:09,284 	gpu = 0
2017-10-27 14:52:09,285 	hidden = 40
2017-10-27 14:52:09,285 	iters = 1
2017-10-27 14:52:09,285 	leaves = True
2017-10-27 14:52:09,285 	load = /home/ih692/jets/models/MPNN/adaptive/Oct-26/3
2017-10-27 14:52:09,285 	model_type = 3
2017-10-27 14:52:09,285 	n_train = -1
2017-10-27 14:52:09,285 	n_valid = 27000
2017-10-27 14:52:09,285 	not_leaves = False
2017-10-27 14:52:09,285 	password = deeplearning
2017-10-27 14:52:09,285 	recipient = henrion@nyu.edu
2017-10-27 14:52:09,285 	restart = True
2017-10-27 14:52:09,285 	seed = 34943
2017-10-27 14:52:09,285 	sender = results74207281@gmail.com
2017-10-27 14:52:09,285 	silent = True
2017-10-27 14:52:09,285 	step_size = 0.001
2017-10-27 14:52:09,285 	verbose = False
2017-10-27 14:52:09,286 	PID = 184461
2017-10-27 14:52:09,286 	Not running on GPU
2017-10-27 14:52:09,286 Loading data...
2017-10-27 14:52:09,286 TF already computed. Loading it.
2017-10-27 14:52:11,068 Data loaded and already preprocessed
2017-10-27 14:52:13,950 Splitting into train and validation...
2017-10-27 14:52:13,979 	raw train size = 73000
2017-10-27 14:52:13,979 	raw valid size = 27000
2017-10-27 14:52:13,979 Cropping...
2017-10-27 14:52:16,327 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 14:52:22,921 	final train size = 89813
2017-10-27 14:52:22,921 	final valid size = 10187
2017-10-27 14:52:22,921 Initializing model...
2017-10-27 14:52:22,947 PredictFromParticleEmbedding (
  (transform): MPNNTransformAdaptive (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPAdaptive (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (48 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPAdaptive (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (48 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 14:52:22,947 Number of parameters: 31923
2017-10-27 14:52:22,947 Building optimizer...
2017-10-27 14:52:22,950 Training...
2017-10-27 14:52:22,950 epoch = 0
2017-10-27 14:52:22,950 step_size = 0.00017684
2017-10-27 15:15:13,775 Modeling validation data took 137.10297226905823s
2017-10-27 15:15:13,816   898	~loss(train)=0.3865	loss(valid)=0.3468	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 97.28	Best 1/FPR @ TPR = 0.5: 97.28
2017-10-27 15:15:15,156 Epoch took 1372.2053928375244 seconds
2017-10-27 15:15:15,156 epoch = 1
2017-10-27 15:15:15,156 step_size = 0.00016623
2017-10-27 15:38:18,855 Modeling validation data took 137.7958788871765s
2017-10-27 15:38:18,861  1796	~loss(train)=0.3852	loss(valid)=0.3470	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 93.38	Best 1/FPR @ TPR = 0.5: 97.28
2017-10-27 15:38:20,355 Epoch took 1385.1990733146667 seconds
2017-10-27 15:38:20,355 epoch = 2
2017-10-27 15:38:20,355 step_size = 0.00015626
2017-10-27 16:01:27,786 Modeling validation data took 138.09810662269592s
2017-10-27 16:01:27,792  2694	~loss(train)=0.3857	loss(valid)=0.3492	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 80.67	Best 1/FPR @ TPR = 0.5: 97.28
2017-10-27 16:01:29,745 Epoch took 1389.390088558197 seconds
2017-10-27 16:01:29,746 epoch = 3
2017-10-27 16:01:29,746 step_size = 0.00014688
2017-10-27 16:24:42,548 Modeling validation data took 137.6039001941681s
2017-10-27 16:24:42,554  3592	~loss(train)=0.3861	loss(valid)=0.3478	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 87.14	Best 1/FPR @ TPR = 0.5: 97.28
2017-10-27 16:24:43,801 Epoch took 1394.0546708106995 seconds
2017-10-27 16:24:43,801 epoch = 4
2017-10-27 16:24:43,801 step_size = 0.00013807
2017-10-27 16:47:37,280 Modeling validation data took 137.5113661289215s
2017-10-27 16:47:37,287  4490	~loss(train)=0.3850	loss(valid)=0.3472	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 89.29	Best 1/FPR @ TPR = 0.5: 97.28
2017-10-27 16:47:38,795 Epoch took 1374.9945230484009 seconds
2017-10-27 16:47:38,796 epoch = 5
2017-10-27 16:47:38,796 step_size = 0.00012978
2017-10-27 17:10:33,505 Modeling validation data took 137.76957178115845s
2017-10-27 17:10:33,511  5388	~loss(train)=0.3847	loss(valid)=0.3470	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 89.99	Best 1/FPR @ TPR = 0.5: 97.28
2017-10-27 17:10:34,712 Epoch took 1375.9163320064545 seconds
2017-10-27 17:10:34,712 epoch = 6
2017-10-27 17:10:34,712 step_size = 0.00012200
2017-10-27 17:33:49,700 Modeling validation data took 139.7834873199463s
2017-10-27 17:33:49,706  6286	~loss(train)=0.3858	loss(valid)=0.3474	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 84.63	Best 1/FPR @ TPR = 0.5: 97.28
2017-10-27 17:33:50,846 Epoch took 1396.1337537765503 seconds
2017-10-27 17:33:50,847 epoch = 7
2017-10-27 17:33:50,847 step_size = 0.00011468
2017-10-27 17:57:22,477 Modeling validation data took 139.8556604385376s
2017-10-27 17:57:22,484  7184	~loss(train)=0.3850	loss(valid)=0.3480	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 95.65	Best 1/FPR @ TPR = 0.5: 97.28
2017-10-27 17:57:23,650 Epoch took 1412.8029880523682 seconds
2017-10-27 17:57:23,650 epoch = 8
2017-10-27 17:57:23,650 step_size = 0.00010780
2017-10-27 18:20:35,364 Modeling validation data took 139.9999098777771s
2017-10-27 18:20:35,381  8082	~loss(train)=0.3838	loss(valid)=0.3480	roc_auc(valid)=0.9218	1/FPR @ TPR = 0.5: 105.02	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 18:20:36,566 Epoch took 1392.9161853790283 seconds
2017-10-27 18:20:36,566 epoch = 9
2017-10-27 18:20:36,567 step_size = 0.00010133
2017-10-27 18:43:38,291 Modeling validation data took 139.0355327129364s
2017-10-27 18:43:38,298  8980	~loss(train)=0.3848	loss(valid)=0.3482	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 90.45	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 18:43:39,491 Epoch took 1382.9240112304688 seconds
2017-10-27 18:43:39,491 epoch = 10
2017-10-27 18:43:39,491 step_size = 0.00009525
2017-10-27 19:06:44,216 Modeling validation data took 137.68323612213135s
2017-10-27 19:06:44,222  9878	~loss(train)=0.3852	loss(valid)=0.3479	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 90.55	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 19:06:45,479 Epoch took 1385.9884526729584 seconds
2017-10-27 19:06:45,480 epoch = 11
2017-10-27 19:06:45,480 step_size = 0.00008953
2017-10-27 19:29:48,338 Modeling validation data took 138.28934144973755s
2017-10-27 19:29:48,344 10776	~loss(train)=0.3860	loss(valid)=0.3484	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 90.14	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 19:29:49,493 Epoch took 1384.0136206150055 seconds
2017-10-27 19:29:49,494 epoch = 12
2017-10-27 19:29:49,494 step_size = 0.00008416
2017-10-27 19:53:08,138 Modeling validation data took 140.05128383636475s
2017-10-27 19:53:08,145 11674	~loss(train)=0.3821	loss(valid)=0.3483	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 95.58	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 19:53:09,359 Epoch took 1399.8646457195282 seconds
2017-10-27 19:53:09,359 epoch = 13
2017-10-27 19:53:09,359 step_size = 0.00007911
2017-10-27 20:16:25,874 Modeling validation data took 138.58199000358582s
2017-10-27 20:16:25,881 12572	~loss(train)=0.3834	loss(valid)=0.3476	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 95.32	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 20:16:27,153 Epoch took 1397.7936820983887 seconds
2017-10-27 20:16:27,153 epoch = 14
2017-10-27 20:16:27,153 step_size = 0.00007437
2017-10-27 20:39:35,466 Modeling validation data took 139.67720651626587s
2017-10-27 20:39:35,472 13470	~loss(train)=0.3832	loss(valid)=0.3493	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 91.44	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 20:39:36,619 Epoch took 1389.4662599563599 seconds
2017-10-27 20:39:36,619 epoch = 15
2017-10-27 20:39:36,620 step_size = 0.00006990
2017-10-27 21:03:08,444 Modeling validation data took 139.54388856887817s
2017-10-27 21:03:08,450 14368	~loss(train)=0.3818	loss(valid)=0.3489	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 87.51	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 21:03:09,994 Epoch took 1413.3744208812714 seconds
2017-10-27 21:03:09,994 epoch = 16
2017-10-27 21:03:09,994 step_size = 0.00006571
2017-10-27 21:26:15,448 Modeling validation data took 138.36726546287537s
2017-10-27 21:26:15,454 15266	~loss(train)=0.3829	loss(valid)=0.3478	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 87.09	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 21:26:16,431 Epoch took 1386.4365220069885 seconds
2017-10-27 21:26:16,431 epoch = 17
2017-10-27 21:26:16,431 step_size = 0.00006177
2017-10-27 21:49:17,881 Modeling validation data took 137.64628672599792s
2017-10-27 21:49:17,887 16164	~loss(train)=0.3825	loss(valid)=0.3486	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 95.18	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 21:49:19,099 Epoch took 1382.6679928302765 seconds
2017-10-27 21:49:19,100 epoch = 18
2017-10-27 21:49:19,100 step_size = 0.00005806
2017-10-27 22:12:02,788 Modeling validation data took 136.30751633644104s
2017-10-27 22:12:02,794 17062	~loss(train)=0.3834	loss(valid)=0.3488	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 91.74	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 22:12:04,099 Epoch took 1364.9994339942932 seconds
2017-10-27 22:12:04,099 epoch = 19
2017-10-27 22:12:04,099 step_size = 0.00005458
2017-10-27 22:34:48,099 Modeling validation data took 135.43427324295044s
2017-10-27 22:34:48,105 17960	~loss(train)=0.3815	loss(valid)=0.3494	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 92.56	Best 1/FPR @ TPR = 0.5: 105.02
2017-10-27 22:34:49,172 Epoch took 1365.0726215839386 seconds
2017-10-27 22:34:49,172 FINISHED TRAINING
2017-10-27 22:34:49,172 Results in models/MPNN/adaptive/Oct-27/14-52-09_3
2017-10-27 22:34:49,173 COMPLETED on Oct-27 at 22:34:49
2017-10-27 22:34:50,044 SENT EMAIL
