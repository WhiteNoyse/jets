2017-10-27 16:10:51,448 models/MPNN/adaptive/Oct-27/16-10-51_9/log.txt
2017-10-27 16:10:51,448 models/MPNN/adaptive/Oct-27/16-10-51_9
2017-10-27 16:10:51,449 Logfile at models/MPNN/adaptive/Oct-27/16-10-51_9/log.txt
2017-10-27 16:10:51,449 	batch_size = 100
2017-10-27 16:10:51,449 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 16:10:51,449 	debug = False
2017-10-27 16:10:51,449 	decay = 0.94
2017-10-27 16:10:51,449 	dont_add_cropped = False
2017-10-27 16:10:51,449 	epochs = 20
2017-10-27 16:10:51,449 	extra_tag = 9
2017-10-27 16:10:51,449 	features = 7
2017-10-27 16:10:51,449 	filename = antikt-kt
2017-10-27 16:10:51,449 	gpu = 0
2017-10-27 16:10:51,449 	hidden = 40
2017-10-27 16:10:51,450 	iters = 1
2017-10-27 16:10:51,450 	leaves = True
2017-10-27 16:10:51,450 	load = /home/ih692/jets/models/MPNN/adaptive/Oct-26/9
2017-10-27 16:10:51,450 	model_type = 3
2017-10-27 16:10:51,450 	n_train = -1
2017-10-27 16:10:51,450 	n_valid = 27000
2017-10-27 16:10:51,450 	not_leaves = False
2017-10-27 16:10:51,450 	password = deeplearning
2017-10-27 16:10:51,450 	recipient = henrion@nyu.edu
2017-10-27 16:10:51,450 	restart = True
2017-10-27 16:10:51,450 	seed = 57836
2017-10-27 16:10:51,450 	sender = results74207281@gmail.com
2017-10-27 16:10:51,450 	silent = True
2017-10-27 16:10:51,450 	step_size = 0.001
2017-10-27 16:10:51,450 	verbose = False
2017-10-27 16:10:51,450 	PID = 75473
2017-10-27 16:10:51,450 	Not running on GPU
2017-10-27 16:10:51,450 Loading data...
2017-10-27 16:10:51,451 TF already computed. Loading it.
2017-10-27 16:10:53,335 Data loaded and already preprocessed
2017-10-27 16:10:56,521 Splitting into train and validation...
2017-10-27 16:10:56,559 	raw train size = 73000
2017-10-27 16:10:56,559 	raw valid size = 27000
2017-10-27 16:10:56,559 Cropping...
2017-10-27 16:10:59,118 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 16:11:06,366 	final train size = 89813
2017-10-27 16:11:06,367 	final valid size = 10187
2017-10-27 16:11:06,367 Initializing model...
2017-10-27 16:11:06,406 PredictFromParticleEmbedding (
  (transform): MPNNTransformAdaptive (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPAdaptive (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (48 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPAdaptive (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (48 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 16:11:06,407 Number of parameters: 31923
2017-10-27 16:11:06,407 Building optimizer...
2017-10-27 16:11:06,410 Training...
2017-10-27 16:11:06,410 epoch = 0
2017-10-27 16:11:06,410 step_size = 0.00017684
2017-10-27 16:35:28,530 Modeling validation data took 146.77782011032104s
2017-10-27 16:35:28,540   898	~loss(train)=0.3876	loss(valid)=0.3486	roc_auc(valid)=0.9218	1/FPR @ TPR = 0.5: 90.47	Best 1/FPR @ TPR = 0.5: 90.47
2017-10-27 16:35:29,791 Epoch took 1463.3806476593018 seconds
2017-10-27 16:35:29,791 epoch = 1
2017-10-27 16:35:29,791 step_size = 0.00016623
2017-10-27 16:59:31,311 Modeling validation data took 146.76315450668335s
2017-10-27 16:59:31,319  1796	~loss(train)=0.3859	loss(valid)=0.3502	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 81.36	Best 1/FPR @ TPR = 0.5: 90.47
2017-10-27 16:59:32,515 Epoch took 1442.723346233368 seconds
2017-10-27 16:59:32,515 epoch = 2
2017-10-27 16:59:32,515 step_size = 0.00015626
2017-10-27 17:23:39,580 Modeling validation data took 148.37299513816833s
2017-10-27 17:23:39,604  2694	~loss(train)=0.3860	loss(valid)=0.3487	roc_auc(valid)=0.9220	1/FPR @ TPR = 0.5: 89.08	Best 1/FPR @ TPR = 0.5: 90.47
2017-10-27 17:23:41,078 Epoch took 1448.5628278255463 seconds
2017-10-27 17:23:41,078 epoch = 3
2017-10-27 17:23:41,078 step_size = 0.00014688
2017-10-27 17:48:28,541 Modeling validation data took 148.17319703102112s
2017-10-27 17:48:28,574  3592	~loss(train)=0.3847	loss(valid)=0.3467	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 93.31	Best 1/FPR @ TPR = 0.5: 93.31
2017-10-27 17:48:30,020 Epoch took 1488.9415485858917 seconds
2017-10-27 17:48:30,020 epoch = 4
2017-10-27 17:48:30,020 step_size = 0.00013807
2017-10-27 18:13:15,165 Modeling validation data took 149.0862638950348s
2017-10-27 18:13:15,175  4490	~loss(train)=0.3844	loss(valid)=0.3481	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 96.89	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 18:13:16,516 Epoch took 1486.495213508606 seconds
2017-10-27 18:13:16,516 epoch = 5
2017-10-27 18:13:16,516 step_size = 0.00012978
2017-10-27 18:38:02,647 Modeling validation data took 148.63380360603333s
2017-10-27 18:38:02,655  5388	~loss(train)=0.3858	loss(valid)=0.3477	roc_auc(valid)=0.9218	1/FPR @ TPR = 0.5: 91.83	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 18:38:04,440 Epoch took 1487.9234097003937 seconds
2017-10-27 18:38:04,440 epoch = 6
2017-10-27 18:38:04,440 step_size = 0.00012200
2017-10-27 19:02:36,071 Modeling validation data took 148.57993745803833s
2017-10-27 19:02:36,078  6286	~loss(train)=0.3832	loss(valid)=0.3471	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 95.15	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 19:02:37,775 Epoch took 1473.3353366851807 seconds
2017-10-27 19:02:37,775 epoch = 7
2017-10-27 19:02:37,776 step_size = 0.00011468
2017-10-27 19:27:04,299 Modeling validation data took 148.340402841568s
2017-10-27 19:27:04,306  7184	~loss(train)=0.3832	loss(valid)=0.3480	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 85.46	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 19:27:05,675 Epoch took 1467.899257659912 seconds
2017-10-27 19:27:05,675 epoch = 8
2017-10-27 19:27:05,675 step_size = 0.00010780
2017-10-27 19:51:48,855 Modeling validation data took 148.63319039344788s
2017-10-27 19:51:48,862  8082	~loss(train)=0.3860	loss(valid)=0.3488	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 93.11	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 19:51:50,129 Epoch took 1484.4540071487427 seconds
2017-10-27 19:51:50,130 epoch = 9
2017-10-27 19:51:50,130 step_size = 0.00010133
2017-10-27 20:16:16,535 Modeling validation data took 148.7192304134369s
2017-10-27 20:16:16,542  8980	~loss(train)=0.3841	loss(valid)=0.3481	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 93.36	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 20:16:17,916 Epoch took 1467.7865843772888 seconds
2017-10-27 20:16:17,917 epoch = 10
2017-10-27 20:16:17,917 step_size = 0.00009525
2017-10-27 20:41:08,664 Modeling validation data took 150.705171585083s
2017-10-27 20:41:08,671  9878	~loss(train)=0.3833	loss(valid)=0.3474	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 93.93	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 20:41:10,492 Epoch took 1492.57510471344 seconds
2017-10-27 20:41:10,492 epoch = 11
2017-10-27 20:41:10,492 step_size = 0.00008953
2017-10-27 21:05:59,143 Modeling validation data took 150.1575469970703s
2017-10-27 21:05:59,150 10776	~loss(train)=0.3830	loss(valid)=0.3477	roc_auc(valid)=0.9219	1/FPR @ TPR = 0.5: 91.35	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 21:06:00,633 Epoch took 1490.140929222107 seconds
2017-10-27 21:06:00,633 epoch = 12
2017-10-27 21:06:00,633 step_size = 0.00008416
2017-10-27 21:30:28,021 Modeling validation data took 150.17080068588257s
2017-10-27 21:30:28,028 11674	~loss(train)=0.3826	loss(valid)=0.3469	roc_auc(valid)=0.9221	1/FPR @ TPR = 0.5: 89.26	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 21:30:29,254 Epoch took 1468.6202132701874 seconds
2017-10-27 21:30:29,254 epoch = 13
2017-10-27 21:30:29,254 step_size = 0.00007911
2017-10-27 21:54:48,271 Modeling validation data took 146.55089330673218s
2017-10-27 21:54:48,278 12572	~loss(train)=0.3818	loss(valid)=0.3474	roc_auc(valid)=0.9218	1/FPR @ TPR = 0.5: 92.95	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 21:54:50,265 Epoch took 1461.0107953548431 seconds
2017-10-27 21:54:50,265 epoch = 14
2017-10-27 21:54:50,265 step_size = 0.00007437
2017-10-27 22:18:59,555 Modeling validation data took 147.6789321899414s
2017-10-27 22:18:59,562 13470	~loss(train)=0.3810	loss(valid)=0.3475	roc_auc(valid)=0.9222	1/FPR @ TPR = 0.5: 87.54	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 22:19:01,004 Epoch took 1450.7384910583496 seconds
2017-10-27 22:19:01,004 epoch = 15
2017-10-27 22:19:01,004 step_size = 0.00006990
2017-10-27 22:43:20,991 Modeling validation data took 147.00888776779175s
2017-10-27 22:43:20,998 14368	~loss(train)=0.3833	loss(valid)=0.3482	roc_auc(valid)=0.9217	1/FPR @ TPR = 0.5: 91.12	Best 1/FPR @ TPR = 0.5: 96.89
2017-10-27 22:43:22,351 Epoch took 1461.346969127655 seconds
2017-10-27 22:43:22,351 epoch = 16
2017-10-27 22:43:22,351 step_size = 0.00006571
2017-10-27 23:07:42,463 Modeling validation data took 143.94638967514038s
2017-10-27 23:07:42,472 15266	~loss(train)=0.3825	loss(valid)=0.3484	roc_auc(valid)=0.9215	1/FPR @ TPR = 0.5: 98.28	Best 1/FPR @ TPR = 0.5: 98.28
2017-10-27 23:07:43,583 Epoch took 1461.231674194336 seconds
2017-10-27 23:07:43,583 epoch = 17
2017-10-27 23:07:43,584 step_size = 0.00006177
2017-10-27 23:31:53,651 Modeling validation data took 143.74251770973206s
2017-10-27 23:31:53,668 16164	~loss(train)=0.3820	loss(valid)=0.3484	roc_auc(valid)=0.9215	1/FPR @ TPR = 0.5: 91.08	Best 1/FPR @ TPR = 0.5: 98.28
2017-10-27 23:31:54,759 Epoch took 1451.175139427185 seconds
2017-10-27 23:31:54,759 epoch = 18
2017-10-27 23:31:54,759 step_size = 0.00005806
2017-10-27 23:55:54,297 Modeling validation data took 143.99962162971497s
2017-10-27 23:55:54,314 17062	~loss(train)=0.3803	loss(valid)=0.3485	roc_auc(valid)=0.9216	1/FPR @ TPR = 0.5: 84.11	Best 1/FPR @ TPR = 0.5: 98.28
2017-10-27 23:55:56,123 Epoch took 1441.3637719154358 seconds
2017-10-27 23:55:56,123 epoch = 19
2017-10-27 23:55:56,123 step_size = 0.00005458
2017-10-28 00:19:42,388 Modeling validation data took 143.97692227363586s
2017-10-28 00:19:42,407 17960	~loss(train)=0.3841	loss(valid)=0.3497	roc_auc(valid)=0.9215	1/FPR @ TPR = 0.5: 88.32	Best 1/FPR @ TPR = 0.5: 98.28
2017-10-28 00:19:43,975 Epoch took 1427.851359128952 seconds
2017-10-28 00:19:43,975 FINISHED TRAINING
2017-10-28 00:19:43,975 Results in models/MPNN/adaptive/Oct-27/16-10-51_9
2017-10-28 00:19:43,975 COMPLETED on Oct-28 at 00:19:43
2017-10-28 00:19:44,900 SENT EMAIL
