2017-10-27 16:07:11,886 models/MPNN/adaptive/Oct-27/16-07-11_8/log.txt
2017-10-27 16:07:11,887 models/MPNN/adaptive/Oct-27/16-07-11_8
2017-10-27 16:07:11,888 Logfile at models/MPNN/adaptive/Oct-27/16-07-11_8/log.txt
2017-10-27 16:07:11,888 	batch_size = 100
2017-10-27 16:07:11,888 	data_dir = /scratch/ih692/data/w-vs-qcd/pickles
2017-10-27 16:07:11,888 	debug = False
2017-10-27 16:07:11,888 	decay = 0.94
2017-10-27 16:07:11,888 	dont_add_cropped = False
2017-10-27 16:07:11,888 	epochs = 20
2017-10-27 16:07:11,888 	extra_tag = 8
2017-10-27 16:07:11,888 	features = 7
2017-10-27 16:07:11,888 	filename = antikt-kt
2017-10-27 16:07:11,888 	gpu = 0
2017-10-27 16:07:11,888 	hidden = 40
2017-10-27 16:07:11,888 	iters = 1
2017-10-27 16:07:11,889 	leaves = True
2017-10-27 16:07:11,889 	load = /home/ih692/jets/models/MPNN/adaptive/Oct-26/8
2017-10-27 16:07:11,889 	model_type = 3
2017-10-27 16:07:11,889 	n_train = -1
2017-10-27 16:07:11,889 	n_valid = 27000
2017-10-27 16:07:11,889 	not_leaves = False
2017-10-27 16:07:11,889 	password = deeplearning
2017-10-27 16:07:11,889 	recipient = henrion@nyu.edu
2017-10-27 16:07:11,889 	restart = True
2017-10-27 16:07:11,889 	seed = 45183
2017-10-27 16:07:11,889 	sender = results74207281@gmail.com
2017-10-27 16:07:11,889 	silent = True
2017-10-27 16:07:11,889 	step_size = 0.001
2017-10-27 16:07:11,889 	verbose = False
2017-10-27 16:07:11,889 	PID = 84431
2017-10-27 16:07:11,889 	Not running on GPU
2017-10-27 16:07:11,889 Loading data...
2017-10-27 16:07:11,891 TF already computed. Loading it.
2017-10-27 16:07:14,903 Data loaded and already preprocessed
2017-10-27 16:07:18,690 Splitting into train and validation...
2017-10-27 16:07:18,716 	raw train size = 73000
2017-10-27 16:07:18,716 	raw valid size = 27000
2017-10-27 16:07:18,716 Cropping...
2017-10-27 16:07:21,615 10187 (selected) + 16813 (cropped) = 27000
2017-10-27 16:07:29,489 	final train size = 89813
2017-10-27 16:07:29,489 	final valid size = 10187
2017-10-27 16:07:29,490 Initializing model...
2017-10-27 16:07:29,546 PredictFromParticleEmbedding (
  (transform): MPNNTransformAdaptive (
    (embedding): Linear (8 -> 40)
    (readout): DTNNReadout (
      (fc1): Linear (40 -> 40)
      (fc2): Linear (40 -> 40)
    )
    (mp_layers): ModuleList (
      (0): MPAdaptive (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (48 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
      (1): MPAdaptive (
        (vertex_update): GRUUpdate (
          (gru): AnyBatchGRUCell (
            (linear_ih): Linear (48 -> 120)
            (linear_hh): Linear (40 -> 120)
          )
        )
        (message): DTNNMessage (
          (vertex_wx_plus_b): Linear (40 -> 40)
        )
        (adjacency_matrix): AdaptiveAdjacencyMatrix (
          (edge_embedding): Linear (40 -> 1)
          (softmax): PaddedMatrixSoftmax (
          )
        )
      )
    )
  )
  (fc1): Linear (40 -> 40)
  (fc2): Linear (40 -> 40)
  (fc3): Linear (40 -> 1)
)
2017-10-27 16:07:29,546 Number of parameters: 31923
2017-10-27 16:07:29,547 Building optimizer...
2017-10-27 16:07:29,550 Training...
2017-10-27 16:07:29,550 epoch = 0
2017-10-27 16:07:29,550 step_size = 0.00018813
2017-10-27 16:32:36,558 Modeling validation data took 148.91247367858887s
2017-10-27 16:32:36,567   898	~loss(train)=0.3866	loss(valid)=0.3466	roc_auc(valid)=0.9226	1/FPR @ TPR = 0.5: 82.06	Best 1/FPR @ TPR = 0.5: 82.06
2017-10-27 16:32:38,430 Epoch took 1508.8795182704926 seconds
2017-10-27 16:32:38,430 epoch = 1
2017-10-27 16:32:38,430 step_size = 0.00017684
2017-10-27 17:00:44,902 Modeling validation data took 149.08375811576843s
2017-10-27 17:00:44,909  1796	~loss(train)=0.3858	loss(valid)=0.3471	roc_auc(valid)=0.9224	1/FPR @ TPR = 0.5: 76.20	Best 1/FPR @ TPR = 0.5: 82.06
2017-10-27 17:00:46,070 Epoch took 1687.639390707016 seconds
2017-10-27 17:00:46,070 epoch = 2
2017-10-27 17:00:46,070 step_size = 0.00016623
2017-10-27 17:28:19,697 Modeling validation data took 142.0339686870575s
2017-10-27 17:28:19,720  2694	~loss(train)=0.3857	loss(valid)=0.3466	roc_auc(valid)=0.9223	1/FPR @ TPR = 0.5: 77.95	Best 1/FPR @ TPR = 0.5: 82.06
2017-10-27 17:28:21,147 Epoch took 1655.0775220394135 seconds
2017-10-27 17:28:21,148 epoch = 3
2017-10-27 17:28:21,148 step_size = 0.00015626
2017-10-27 17:54:33,517 Modeling validation data took 142.5912308692932s
2017-10-27 17:54:33,542  3592	~loss(train)=0.3849	loss(valid)=0.3453	roc_auc(valid)=0.9231	1/FPR @ TPR = 0.5: 82.22	Best 1/FPR @ TPR = 0.5: 82.22
2017-10-27 17:54:35,295 Epoch took 1574.1473109722137 seconds
2017-10-27 17:54:35,295 epoch = 4
2017-10-27 17:54:35,296 step_size = 0.00014688
2017-10-27 18:19:32,216 Modeling validation data took 150.18011140823364s
2017-10-27 18:19:32,222  4490	~loss(train)=0.3889	loss(valid)=0.3479	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 81.37	Best 1/FPR @ TPR = 0.5: 82.22
2017-10-27 18:19:33,543 Epoch took 1498.2477152347565 seconds
2017-10-27 18:19:33,544 epoch = 5
2017-10-27 18:19:33,544 step_size = 0.00013807
2017-10-27 18:45:14,872 Modeling validation data took 150.36833548545837s
2017-10-27 18:45:14,881  5388	~loss(train)=0.3845	loss(valid)=0.3459	roc_auc(valid)=0.9228	1/FPR @ TPR = 0.5: 83.31	Best 1/FPR @ TPR = 0.5: 83.31
2017-10-27 18:45:16,452 Epoch took 1542.9080214500427 seconds
2017-10-27 18:45:16,452 epoch = 6
2017-10-27 18:45:16,452 step_size = 0.00012978
2017-10-27 19:10:57,507 Modeling validation data took 143.24140000343323s
2017-10-27 19:10:57,513  6286	~loss(train)=0.3836	loss(valid)=0.3467	roc_auc(valid)=0.9229	1/FPR @ TPR = 0.5: 80.54	Best 1/FPR @ TPR = 0.5: 83.31
2017-10-27 19:10:59,407 Epoch took 1542.9550428390503 seconds
2017-10-27 19:10:59,407 epoch = 7
2017-10-27 19:10:59,407 step_size = 0.00012200
2017-10-27 19:36:30,565 Modeling validation data took 143.42245888710022s
2017-10-27 19:36:30,574  7184	~loss(train)=0.3859	loss(valid)=0.3460	roc_auc(valid)=0.9228	1/FPR @ TPR = 0.5: 86.54	Best 1/FPR @ TPR = 0.5: 86.54
2017-10-27 19:36:31,827 Epoch took 1532.4198751449585 seconds
2017-10-27 19:36:31,828 epoch = 8
2017-10-27 19:36:31,828 step_size = 0.00011468
2017-10-27 20:02:45,294 Modeling validation data took 150.80361199378967s
2017-10-27 20:02:45,313  8082	~loss(train)=0.3851	loss(valid)=0.3457	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 84.70	Best 1/FPR @ TPR = 0.5: 86.54
2017-10-27 20:02:46,534 Epoch took 1574.7064411640167 seconds
2017-10-27 20:02:46,534 epoch = 9
2017-10-27 20:02:46,535 step_size = 0.00010780
2017-10-27 20:29:59,634 Modeling validation data took 148.7231092453003s
2017-10-27 20:29:59,640  8980	~loss(train)=0.3845	loss(valid)=0.3463	roc_auc(valid)=0.9228	1/FPR @ TPR = 0.5: 77.67	Best 1/FPR @ TPR = 0.5: 86.54
2017-10-27 20:30:01,893 Epoch took 1635.3579642772675 seconds
2017-10-27 20:30:01,893 epoch = 10
2017-10-27 20:30:01,893 step_size = 0.00010133
2017-10-27 20:59:07,439 Modeling validation data took 150.3579137325287s
2017-10-27 20:59:07,446  9878	~loss(train)=0.3832	loss(valid)=0.3460	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 80.93	Best 1/FPR @ TPR = 0.5: 86.54
2017-10-27 20:59:09,030 Epoch took 1747.1368815898895 seconds
2017-10-27 20:59:09,030 epoch = 11
2017-10-27 20:59:09,030 step_size = 0.00009525
2017-10-27 21:30:53,082 Modeling validation data took 151.9511444568634s
2017-10-27 21:30:53,089 10776	~loss(train)=0.3828	loss(valid)=0.3457	roc_auc(valid)=0.9232	1/FPR @ TPR = 0.5: 85.89	Best 1/FPR @ TPR = 0.5: 86.54
2017-10-27 21:30:54,536 Epoch took 1905.5061130523682 seconds
2017-10-27 21:30:54,537 epoch = 12
2017-10-27 21:30:54,537 step_size = 0.00008953
2017-10-27 22:04:24,801 Modeling validation data took 154.15890073776245s
2017-10-27 22:04:24,807 11674	~loss(train)=0.3829	loss(valid)=0.3471	roc_auc(valid)=0.9225	1/FPR @ TPR = 0.5: 77.96	Best 1/FPR @ TPR = 0.5: 86.54
2017-10-27 22:04:26,846 Epoch took 2012.3095963001251 seconds
2017-10-27 22:04:26,847 epoch = 13
2017-10-27 22:04:26,847 step_size = 0.00008416
2017-10-27 22:36:38,540 Modeling validation data took 154.08634519577026s
2017-10-27 22:36:38,557 12572	~loss(train)=0.3826	loss(valid)=0.3466	roc_auc(valid)=0.9228	1/FPR @ TPR = 0.5: 82.30	Best 1/FPR @ TPR = 0.5: 86.54
2017-10-27 22:36:39,861 Epoch took 1933.0138301849365 seconds
2017-10-27 22:36:39,861 epoch = 14
2017-10-27 22:36:39,861 step_size = 0.00007911
2017-10-27 23:06:51,861 Modeling validation data took 141.47404742240906s
2017-10-27 23:06:51,869 13470	~loss(train)=0.3820	loss(valid)=0.3450	roc_auc(valid)=0.9235	1/FPR @ TPR = 0.5: 91.21	Best 1/FPR @ TPR = 0.5: 91.21
2017-10-27 23:06:53,006 Epoch took 1813.145138502121 seconds
2017-10-27 23:06:53,007 epoch = 15
2017-10-27 23:06:53,007 step_size = 0.00007437
2017-10-27 23:32:40,568 Modeling validation data took 141.59188151359558s
2017-10-27 23:32:40,584 14368	~loss(train)=0.3816	loss(valid)=0.3456	roc_auc(valid)=0.9235	1/FPR @ TPR = 0.5: 83.33	Best 1/FPR @ TPR = 0.5: 91.21
2017-10-27 23:32:42,305 Epoch took 1549.298178911209 seconds
2017-10-27 23:32:42,305 epoch = 16
2017-10-27 23:32:42,305 step_size = 0.00006990
2017-10-27 23:58:57,455 Modeling validation data took 141.32847499847412s
2017-10-27 23:58:57,479 15266	~loss(train)=0.3819	loss(valid)=0.3457	roc_auc(valid)=0.9231	1/FPR @ TPR = 0.5: 88.58	Best 1/FPR @ TPR = 0.5: 91.21
2017-10-27 23:58:59,028 Epoch took 1576.7225120067596 seconds
2017-10-27 23:58:59,028 epoch = 17
2017-10-27 23:58:59,028 step_size = 0.00006571
2017-10-28 00:26:17,802 Modeling validation data took 150.97047400474548s
2017-10-28 00:26:17,826 16164	~loss(train)=0.3813	loss(valid)=0.3455	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 83.14	Best 1/FPR @ TPR = 0.5: 91.21
2017-10-28 00:26:19,048 Epoch took 1640.0198085308075 seconds
2017-10-28 00:26:19,048 epoch = 18
2017-10-28 00:26:19,048 step_size = 0.00006177
2017-10-28 00:53:37,216 Modeling validation data took 143.94597840309143s
2017-10-28 00:53:37,243 17062	~loss(train)=0.3812	loss(valid)=0.3453	roc_auc(valid)=0.9230	1/FPR @ TPR = 0.5: 77.96	Best 1/FPR @ TPR = 0.5: 91.21
2017-10-28 00:53:38,616 Epoch took 1639.5675847530365 seconds
2017-10-28 00:53:38,616 epoch = 19
2017-10-28 00:53:38,616 step_size = 0.00005806
2017-10-28 01:21:26,210 Modeling validation data took 143.710307598114s
2017-10-28 01:21:26,234 17960	~loss(train)=0.3805	loss(valid)=0.3459	roc_auc(valid)=0.9231	1/FPR @ TPR = 0.5: 78.72	Best 1/FPR @ TPR = 0.5: 91.21
2017-10-28 01:21:27,732 Epoch took 1669.1155405044556 seconds
2017-10-28 01:21:27,732 FINISHED TRAINING
2017-10-28 01:21:27,732 Results in models/MPNN/adaptive/Oct-27/16-07-11_8
2017-10-28 01:21:27,732 COMPLETED on Oct-28 at 01:21:27
2017-10-28 01:21:28,849 SENT EMAIL
